  0%|                                                    | 0/80 [00:00<?, ?it/s]
0 25113 0.40127140283584595
1 25113 0.6142809391021729
2 25113 0.3846280574798584
3 25113 0.37812289595603943
4 25113 0.4453746974468231
5 25113 0.3321991264820099
6 25113 0.3704586327075958
7 25113 0.35667356848716736
8 25113 0.3133387267589569
9 25113 0.2956409752368927
10 25113 0.3491542339324951
11 25113 0.36834120750427246
12 25113 0.4862656891345978
13 25113 0.39706677198410034
14 25113 0.4946814775466919
15 25113 0.34891098737716675
16 25113 0.2849002778530121
17 25113 0.2638116180896759
18 25113 0.33792588114738464
19 25113 0.3237692713737488
20 25113 0.31430360674858093
21 25113 0.3084366023540497
22 25113 0.2734390199184418
23 25113 0.3155752718448639
24 25113 0.31709617376327515
25 25113 0.3152347207069397
26 25113 0.29695960879325867
27 25113 0.3155745565891266
28 25113 0.3221161365509033
29 25113 0.2552958130836487
30 25113 0.28897103667259216
31 25113 0.34078559279441833
32 25113 0.27693817019462585
33 25113 0.2704123258590698
34 25113 0.32632413506507874
35 25113 0.3035803437232971
36 25113 0.32432499527931213
37 25113 0.2869616746902466
38 25113 0.307903915643692
39 25113 0.28642967343330383
40 25113 0.226095050573349
41 25113 0.3719012141227722
42 25113 0.21611644327640533
43 25113 0.22267751395702362
44 25113 0.20102035999298096
45 25113 0.2734902799129486
46 25113 0.2728865444660187
47 25113 0.26437073945999146
48 25113 0.25997892022132874
49 25113 0.2780510187149048
50 25113 0.2735878527164459
51 25113 0.30124425888061523
52 25113 0.2812780439853668
53 25113 0.3150564730167389
54 25113 0.31228622794151306
55 25113 0.2944730818271637
56 25113 0.290927916765213
57 25113 0.2502534091472626
58 25113 0.2833584249019623
59 25113 0.35934728384017944
60 25113 0.35317686200141907
61 25113 0.31257379055023193
62 25113 0.3466458320617676
63 25113 0.3066679537296295
64 25113 0.2931540310382843
65 25113 0.2913881540298462
66 25113 0.2586829662322998
67 25113 0.31640732288360596
68 25113 0.1949789673089981
69 25113 0.296297162771225
70 25113 0.2544546127319336
71 25113 0.26368939876556396
72 25113 0.24645957350730896
73 25113 0.16690398752689362
74 25113 0.30509087443351746
75 25113 0.2107887715101242
76 25113 0.2870434820652008
77 25113 0.26108378171920776
78 25113 0.3083955943584442
79 25113 0.29232072830200195
80 25113 0.1992744654417038
81 25113 0.18640391528606415
82 25113 0.25026214122772217
83 25113 0.42919835448265076
84 25113 0.3974369764328003
85 25113 0.26675283908843994
86 25113 0.3317267596721649
87 25113 0.3849620819091797
88 25113 0.2844974398612976
89 25113 0.27262887358665466
90 25113 0.2333623319864273
91 25113 0.3460424244403839
92 25113 0.2478552609682083
93 25113 0.28134673833847046
94 25113 0.2735584080219269
95 25113 0.2692337930202484
96 25113 0.2019708752632141
97 25113 0.25272268056869507
98 25113 0.27155953645706177
99 25113 0.30562475323677063
100 25113 0.2590765655040741
101 25113 0.19672124087810516
102 25113 0.15420998632907867
103 25113 0.33279022574424744
104 25113 0.28624820709228516
105 25113 0.2965494990348816
106 25113 0.26878827810287476
107 25113 0.3787769079208374
108 25113 0.2395617663860321
109 25113 0.2953082025051117
110 25113 0.35024386644363403
111 25113 0.3266465961933136
112 25113 0.27254512906074524
113 25113 0.28692975640296936
114 25113 0.3734174966812134
115 25113 0.2968633472919464
116 25113 0.2506846785545349
117 25113 0.2862308621406555
118 25113 0.4059528112411499
119 25113 0.24690906703472137
120 25113 0.29867619276046753
121 25113 0.28868862986564636
122 25113 0.38875147700309753
123 25113 0.3661218583583832
124 25113 0.26656201481819153
125 25113 0.27372613549232483
126 25113 0.17041777074337006
127 25113 0.3549323081970215
128 25113 0.18237334489822388
129 25113 0.1797303855419159
130 25113 0.22410866618156433
131 25113 0.31657475233078003
132 25113 0.15979081392288208
133 25113 0.2827659547328949
134 25113 0.16525334119796753
135 25113 0.27437785267829895
136 25113 0.261108934879303
137 25113 0.24516230821609497
138 25113 0.18900538980960846
139 25113 0.3157934546470642
train - Global loss: 0.295735    Embedding norm: 1.0000   Triplets (all/active): 179.4/28463.6
Pos dist (min/mean/max): 0.4361/0.7923/1.1549   Neg dist (min/mean/max): 0.5708/1.0257/1.3691
0 1011 0.24503691494464874
1 1011 0.16867120563983917
2 1011 0.16445553302764893
3 1011 0.2378349006175995
4 1011 0.19326463341712952
5 1011 0.1587815135717392
val - Global loss: 0.194674    Embedding norm: 1.0000   Triplets (all/active): 168.5/28678.3
Pos dist (min/mean/max): 0.0663/0.1677/0.4387   Neg dist (min/mean/max): 0.0745/0.2248/0.6442
0 25113 0.19404669106006622
1 25113 0.22865042090415955
2 25113 0.18207892775535583
3 25113 0.15374097228050232
4 25113 0.2335571050643921
5 25113 0.31965017318725586
6 25113 0.3104783892631531
7 25113 0.1915518343448639
8 25113 0.253877192735672
9 25113 0.30018550157546997
10 25113 0.2092321813106537
11 25113 0.246552973985672
12 25113 0.20680703222751617
13 25113 0.5862447023391724
14 25113 0.2718314826488495
15 25113 0.28585776686668396
16 25113 0.2612399160861969
17 25113 0.29735517501831055
18 25113 0.45914319157600403
19 25113 0.5048279166221619
20 25113 0.3342738747596741
21 25113 0.48679134249687195
22 25113 0.3786352872848511
23 25113 0.4131605923175812
24 25113 0.402890145778656
25 25113 0.344635546207428
26 25113 0.3115057647228241
27 25113 0.4069497287273407
28 25113 0.3267275094985962
29 25113 0.2498129904270172
30 25113 0.38385629653930664
31 25113 0.3248790204524994
32 25113 0.28132978081703186
33 25113 0.34333765506744385
34 25113 0.3549708127975464
35 25113 0.39369475841522217
36 25113 0.3209977149963379
37 25113 0.28468501567840576
38 25113 0.34121230244636536
39 25113 0.26925361156463623
40 25113 0.2986864745616913
41 25113 0.3722487986087799
42 25113 0.29267483949661255
43 25113 0.27903228998184204
44 25113 0.25908148288726807
45 25113 0.38070976734161377
46 25113 0.2843339145183563
47 25113 0.23140089213848114
48 25113 0.24171757698059082
49 25113 0.3021188974380493
50 25113 0.31577807664871216
51 25113 0.3277842402458191
52 25113 0.27950647473335266
53 25113 0.3086688220500946
54 25113 0.2366659790277481
55 25113 0.25139638781547546
56 25113 0.2580321729183197
57 25113 0.18587632477283478
58 25113 0.23072616755962372
59 25113 0.3979377746582031
60 25113 0.29416966438293457
61 25113 0.2776387333869934
62 25113 0.3090642988681793
63 25113 0.4311501383781433
64 25113 0.39015746116638184
65 25113 0.3555375933647156
66 25113 0.21780724823474884
67 25113 0.2893153131008148
68 25113 0.2610779404640198
69 25113 0.34316286444664
70 25113 0.22982442378997803
71 25113 0.21571101248264313
72 25113 0.20752395689487457
73 25113 0.1608726978302002
74 25113 0.25185853242874146
75 25113 0.22456412017345428
76 25113 0.17238454520702362
77 25113 0.22510476410388947
78 25113 0.20577380061149597
79 25113 0.2534467279911041
80 25113 0.20177659392356873
81 25113 0.12622152268886566
82 25113 0.15660317242145538
83 25113 0.45539432764053345
84 25113 0.22520385682582855
85 25113 0.2077673226594925
86 25113 0.28194496035575867
87 25113 0.43302392959594727
88 25113 0.3513762056827545
89 25113 0.18515443801879883
90 25113 0.15473107993602753
91 25113 0.28239673376083374
92 25113 0.20625169575214386
93 25113 0.18911150097846985
94 25113 0.15634386241436005
95 25113 0.18210624158382416
96 25113 0.17538699507713318
97 25113 0.10256968438625336
98 25113 0.10403027385473251
99 25113 0.142859548330307
100 25113 0.10844864696264267
101 25113 0.36336755752563477
102 25113 0.11722780764102936
103 25113 0.2693299949169159
104 25113 0.19786252081394196
105 25113 0.1892726719379425
106 25113 0.15975652635097504
107 25113 0.10091682523488998
108 25113 0.11524556577205658
109 25113 0.20188786089420319
110 25113 0.06964226812124252
111 25113 0.2261771708726883
112 25113 0.08920764178037643
113 25113 0.16737383604049683
114 25113 0.22337892651557922
115 25113 0.027716610580682755
116 25113 0.2593802213668823
117 25113 0.17746467888355255
118 25113 0.21716471016407013
119 25113 0.25296738743782043
120 25113 0.2171076089143753
121 25113 0.21258977055549622
122 25113 0.6007570624351501
123 25113 0.5798565745353699
124 25113 0.387381374835968
125 25113 0.3567476272583008
126 25113 0.2808831036090851
127 25113 0.6190817356109619
128 25113 0.1086459830403328
129 25113 0.11158918589353561
130 25113 0.19176258146762848
131 25113 0.1729458123445511
132 25113 0.05783524736762047
133 25113 0.1479630321264267
134 25113 0.08685804158449173
135 25113 0.1816023737192154
136 25113 0.04514767974615097
137 25113 0.06813433021306992
138 25113 0.1627035140991211
139 25113 0.27763786911964417
train - Global loss: 0.260159    Embedding norm: 1.0000   Triplets (all/active): 179.4/19195.2
Pos dist (min/mean/max): 0.4420/0.8468/1.2659   Neg dist (min/mean/max): 0.6921/1.2731/1.6681
0 1011 0.20822188258171082
1 1011 0.20178769528865814
2 1011 0.20508934557437897
3 1011 0.2236286848783493
4 1011 0.2357480674982071
5 1011 0.18571481108665466
val - Global loss: 0.210032    Embedding norm: 1.0000   Triplets (all/active): 168.5/28742.0
Pos dist (min/mean/max): 0.1354/0.2334/0.5095   Neg dist (min/mean/max): 0.1189/0.2909/0.7251
0 25113 0.0493205226957798
1 25113 0.1765902042388916
2 25113 0.6354236006736755
3 25113 0.267524778842926
4 25113 0.28597334027290344
5 25113 0.23447594046592712
6 25113 0.2103981375694275
7 25113 0.1612253040075302
8 25113 0.14019833505153656
9 25113 0.18072509765625
10 25113 0.12677203118801117
11 25113 0.1534208506345749
12 25113 0.059105176478624344
13 25113 0.7388793230056763
14 25113 0.442419171333313
15 25113 0.06400681287050247
16 25113 0.03930957242846489
17 25113 0.0
18 25113 0.5914925336837769
19 25113 0.70747309923172
20 25113 0.49245887994766235
21 25113 0.29405805468559265
22 25113 0.4080391824245453
23 25113 0.5011436343193054
24 25113 0.202474445104599
25 25113 0.06159178540110588
26 25113 0.4695235788822174
27 25113 0.29253706336021423
28 25113 0.09189047664403915
29 25113 0.13962402939796448
30 25113 0.12694865465164185
31 25113 0.4788855016231537
32 25113 0.12645672261714935
33 25113 0.1954096555709839
34 25113 0.15314039587974548
35 25113 0.1649966537952423
36 25113 0.27130934596061707
37 25113 0.13865385949611664
38 25113 0.15256774425506592
39 25113 0.22325436770915985
40 25113 0.2697971761226654
41 25113 0.3753601610660553
42 25113 0.28854137659072876
43 25113 0.12913626432418823
44 25113 0.11698031425476074
45 25113 0.4814342260360718
46 25113 0.641859233379364
47 25113 0.6045463681221008
48 25113 0.3619571328163147
49 25113 0.24459411203861237
50 25113 0.32372596859931946
51 25113 0.35936668515205383
52 25113 nan
53 25113 nan
54 25113 nan
55 25113 nan
56 25113 nan
57 25113 nan
58 25113 nan
59 25113 nan
60 25113 nan
61 25113 nan
62 25113 nan
63 25113 nan
64 25113 nan
65 25113 nan
66 25113 nan
67 25113 nan
68 25113 nan
69 25113 nan
70 25113 nan
71 25113 nan
72 25113 nan
73 25113 nan
74 25113 nan
75 25113 nan
76 25113 nan
77 25113 nan
78 25113 nan
79 25113 nan
80 25113 nan
81 25113 nan
82 25113 nan
83 25113 nan
84 25113 nan
85 25113 nan
86 25113 nan
87 25113 nan
88 25113 nan
89 25113 nan
90 25113 nan
91 25113 nan
92 25113 nan
93 25113 nan
94 25113 nan
95 25113 nan
96 25113 nan
Traceback (most recent call last):
  File "/code/RLoc/training/train.py", line 31, in <module>
    do_train(params, debug=args.debug, device=device)
  File "/code/RLoc/training/trainer.py", line 410, in do_train
    torch.cuda.empty_cache()
  File "/usr/local/lib/python3.9/site-packages/torch/cuda/memory.py", line 121, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
