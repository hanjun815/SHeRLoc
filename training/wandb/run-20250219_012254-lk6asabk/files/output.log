  0%|                                                           | 0/80 [00:00<?, ?it/s]
0 25113 0.3739931583404541
1 25113 0.46013909578323364
2 25113 0.3058600425720215
3 25113 0.303033709526062
4 25113 0.3106003403663635
5 25113 0.3076495826244354
6 25113 0.29850587248802185
7 25113 0.3043802082538605
8 25113 0.30252575874328613
9 25113 0.3037266731262207
10 25113 0.30138614773750305
11 25113 0.2940031886100769
12 25113 0.3021361827850342
13 25113 0.28932857513427734
14 25113 0.29292845726013184
15 25113 0.2958802580833435
16 25113 0.2903764247894287
17 25113 0.2925865650177002
18 25113 0.2923746109008789
19 25113 0.28205785155296326
20 25113 0.2824631333351135
21 25113 0.28236275911331177
22 25113 0.28037333488464355
23 25113 0.27835386991500854
24 25113 0.2884185314178467
25 25113 0.29088786244392395
26 25113 0.3119300305843353
27 25113 0.2984492778778076
28 25113 0.29724717140197754
29 25113 0.2953549027442932
30 25113 0.291538268327713
31 25113 0.29646778106689453
32 25113 0.2757810354232788
33 25113 0.2926391363143921
34 25113 0.28843551874160767
35 25113 0.2903585135936737
36 25113 0.2903537154197693
37 25113 0.28413739800453186
38 25113 0.27040573954582214
39 25113 0.2955396771430969
40 25113 0.2771609425544739
41 25113 0.2899667024612427
42 25113 0.2737617492675781
43 25113 0.280836284160614
44 25113 0.2796494662761688
45 25113 0.25845253467559814
46 25113 0.27634894847869873
47 25113 0.28067314624786377
48 25113 0.27101045846939087
49 25113 0.28105229139328003
50 25113 0.27579787373542786
51 25113 0.26065918803215027
52 25113 0.2734341323375702
53 25113 0.2648497223854065
54 25113 0.26086193323135376
55 25113 0.25248464941978455
56 25113 0.2857443690299988
57 25113 0.2631532847881317
58 25113 0.26921263337135315
59 25113 0.2591998875141144
60 25113 0.2549768090248108
61 25113 0.28697288036346436
62 25113 0.2447691112756729
63 25113 0.2729712724685669
64 25113 0.28479689359664917
65 25113 0.2706875205039978
66 25113 0.27187496423721313
67 25113 0.25670626759529114
68 25113 0.2672690451145172
69 25113 0.2779986262321472
70 25113 0.2759084701538086
71 25113 0.26941394805908203
72 25113 0.2673259973526001
73 25113 0.2941811680793762
74 25113 0.2629994750022888
75 25113 0.26160162687301636
76 25113 0.2521425485610962
77 25113 0.27299290895462036
78 25113 0.28517842292785645
79 25113 0.29528579115867615
80 25113 0.28828030824661255
81 25113 0.2965294420719147
82 25113 0.2964094281196594
83 25113 0.3047652542591095
84 25113 0.27340105175971985
85 25113 0.3036365211009979
86 25113 0.2743987739086151
87 25113 0.2958713173866272
88 25113 0.29601967334747314
89 25113 0.26980361342430115
90 25113 0.2520970404148102
91 25113 0.2825971245765686
92 25113 0.26332926750183105
93 25113 0.2766496241092682
94 25113 0.25871962308883667
95 25113 0.27155178785324097
96 25113 0.26697224378585815
97 25113 0.2979545295238495
98 25113 0.2705253064632416
train - Global loss: 0.284695    Embedding norm: 1.0000   Triplets (all/active): 253.7/64880.3
Pos dist (min/mean/max): 0.0405/0.0783/0.1467   Neg dist (min/mean/max): 0.0571/0.1409/0.2371
0 1011 0.30313193798065186
1 1011 0.3048141598701477
2 1011 0.3249697685241699
3 1011 0.3377264142036438
val - Global loss: 0.317661    Embedding norm: 1.0000   Triplets (all/active): 252.8/63914.2
Pos dist (min/mean/max): 0.0126/0.0736/0.1918   Neg dist (min/mean/max): 0.0131/0.1216/0.2739
0 25113 0.2648106813430786
1 25113 0.22526933252811432
2 25113 0.23411838710308075
3 25113 0.2603414058685303
4 25113 0.26195549964904785
5 25113 0.23207753896713257
6 25113 0.20061102509498596
7 25113 0.2942911982536316
8 25113 0.1970667839050293
9 25113 0.34414374828338623
10 25113 0.27004697918891907
11 25113 0.28583699464797974
12 25113 0.31320708990097046
13 25113 0.25026506185531616
14 25113 0.2857006788253784
15 25113 0.2948482632637024
16 25113 0.2895802855491638
17 25113 0.2598491311073303
18 25113 0.2392866611480713
19 25113 0.24533143639564514
20 25113 0.19006364047527313
21 25113 0.25390973687171936
22 25113 0.2416236698627472
23 25113 0.22024986147880554
24 25113 0.31602418422698975
25 25113 0.33995428681373596
26 25113 0.41146764159202576
27 25113 0.4480474293231964
28 25113 0.33375293016433716
29 25113 0.3495500683784485
30 25113 0.3095155358314514
31 25113 0.3214588165283203
32 25113 0.2862298786640167
33 25113 0.2924724817276001
34 25113 0.2898424565792084
35 25113 0.3062989413738251
36 25113 0.2869035303592682
37 25113 0.29657912254333496
38 25113 0.29269129037857056
39 25113 0.3050920367240906
40 25113 0.2871198058128357
41 25113 0.30213481187820435
42 25113 0.2788882255554199
43 25113 0.2944284677505493
44 25113 0.29572930932044983
45 25113 0.27790960669517517
46 25113 0.3005029559135437
47 25113 0.2890499234199524
48 25113 0.2912568151950836
49 25113 0.27837255597114563
50 25113 0.2771245837211609
51 25113 0.2597702741622925
52 25113 0.2732589840888977
53 25113 0.2763935327529907
54 25113 0.27248090505599976
55 25113 0.27126049995422363
56 25113 0.2906898856163025
57 25113 0.2601469159126282
58 25113 0.2691167891025543
59 25113 0.24031096696853638
60 25113 0.26194244623184204
61 25113 0.27472540736198425
62 25113 0.21819373965263367
63 25113 0.2794882357120514
64 25113 0.27581584453582764
65 25113 0.23832471668720245
66 25113 0.20590272545814514
67 25113 0.21132560074329376
68 25113 0.1710355281829834
69 25113 0.23414447903633118
70 25113 0.20290595293045044
71 25113 0.3055405020713806
72 25113 0.2754483222961426
73 25113 0.27871009707450867
74 25113 0.21953681111335754
75 25113 0.18314479291439056
76 25113 0.24196848273277283
77 25113 0.3485705554485321
78 25113 0.3694097101688385
79 25113 0.3815785050392151
80 25113 0.28763633966445923
81 25113 0.30320870876312256
82 25113 0.35752803087234497
83 25113 0.324888676404953
84 25113 0.27511802315711975
85 25113 0.36042776703834534
86 25113 0.36895379424095154
87 25113 0.35126274824142456
88 25113 0.32901066541671753
89 25113 0.3316556215286255
90 25113 0.33416470885276794
91 25113 0.3782689571380615
92 25113 0.28135186433792114
93 25113 0.2681332230567932
94 25113 0.27885276079177856
95 25113 0.2940666675567627
96 25113 0.28801146149635315
97 25113 0.3130333423614502
98 25113 0.31076353788375854
train - Global loss: 0.284246    Embedding norm: 1.0000   Triplets (all/active): 253.7/63931.2
Pos dist (min/mean/max): 0.0819/0.1908/0.3886   Neg dist (min/mean/max): 0.1024/0.3571/0.6372
0 1011 0.2919362783432007
1 1011 0.33463191986083984
2 1011 0.29815930128097534
3 1011 0.36983340978622437
val - Global loss: 0.323640    Embedding norm: 1.0000   Triplets (all/active): 252.8/63914.2
Pos dist (min/mean/max): 0.0549/0.1811/0.3546   Neg dist (min/mean/max): 0.0496/0.2539/0.4686
0 25113 0.28721266984939575
1 25113 0.2568487524986267
2 25113 0.26658231019973755
3 25113 0.28054070472717285
4 25113 0.27861613035202026
5 25113 0.2768328785896301
6 25113 0.275748074054718
7 25113 0.30761411786079407
8 25113 0.2984539270401001
9 25113 0.31188124418258667
10 25113 0.29862087965011597
11 25113 0.277586430311203
12 25113 0.3080439269542694
13 25113 0.2801019549369812
14 25113 0.23459488153457642
15 25113 0.28703010082244873
16 25113 0.284087210893631
17 25113 0.25482457876205444
Traceback (most recent call last):
  File "/code/RLoc/training/train.py", line 31, in <module>
    do_train(params, debug=args.debug, device=device)
  File "/code/RLoc/training/trainer.py", line 396, in do_train
    loss, temp_stats, _ = loss_fn(vladQ, vladP, vladN)
  File "/code/RLoc/models/loss.py", line 276, in __call__
    hardest_vladP = vladP[b][pos_dist.argmax()]  # Hardest positive
KeyboardInterrupt
