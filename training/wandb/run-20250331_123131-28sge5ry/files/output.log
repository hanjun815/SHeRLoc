  0%|                                                                   | 0/80 [00:00<?, ?it/s]
0 25113 2.2395293712615967
1 25113 6.884928226470947
2 25113 4.5708394050598145
3 25113 3.2100210189819336
4 25113 2.866058349609375
5 25113 4.485383033752441
6 25113 3.5078275203704834
7 25113 2.8356192111968994
8 25113 3.4644789695739746
9 25113 3.870434284210205
10 25113 2.197317361831665
11 25113 4.455230236053467
12 25113 3.819467782974243
13 25113 3.319187879562378
14 25113 5.101842403411865
15 25113 3.739082098007202
16 25113 3.2138097286224365
17 25113 3.4947268962860107
18 25113 4.510791301727295
19 25113 4.300149440765381
20 25113 3.3918397426605225
21 25113 3.3174853324890137
22 25113 4.1845808029174805
23 25113 4.531348705291748
24 25113 5.594560146331787
25 25113 4.198384761810303
26 25113 4.994904518127441
27 25113 3.3604931831359863
28 25113 4.450876712799072
29 25113 3.86719012260437
30 25113 3.2071707248687744
31 25113 4.071519374847412
32 25113 3.1474621295928955
33 25113 3.250062942504883
34 25113 2.0774619579315186
35 25113 3.8317222595214844
36 25113 3.2968831062316895
37 25113 3.7534377574920654
38 25113 3.3282196521759033
39 25113 3.90405011177063
40 25113 3.7574453353881836
41 25113 3.1615843772888184
42 25113 4.3138203620910645
43 25113 3.854995012283325
44 25113 3.789649486541748
45 25113 4.074558734893799
46 25113 5.229691982269287
47 25113 3.2712936401367188
48 25113 3.5473387241363525
49 25113 4.5018720626831055
50 25113 3.173515558242798
51 25113 3.3928780555725098
52 25113 2.708444833755493
53 25113 2.843099594116211
54 25113 3.127932071685791
55 25113 2.7276699542999268
56 25113 2.2714602947235107
57 25113 2.9756388664245605
58 25113 2.815990447998047
59 25113 2.9015402793884277
60 25113 2.3980815410614014
61 25113 2.1465442180633545
62 25113 2.7435660362243652
63 25113 2.4798171520233154
64 25113 4.600058555603027
65 25113 2.2585256099700928
66 25113 1.8981945514678955
67 25113 2.8871023654937744
68 25113 3.1966397762298584
69 25113 3.795912265777588
70 25113 3.709958791732788
71 25113 4.9676408767700195
72 25113 3.1626317501068115
73 25113 3.2647480964660645
74 25113 3.3852295875549316
75 25113 3.7069599628448486
76 25113 3.375213384628296
77 25113 2.550560235977173
78 25113 2.6405975818634033
79 25113 4.646862506866455
80 25113 2.968064546585083
81 25113 3.153700351715088
82 25113 2.1430070400238037
83 25113 5.117821216583252
84 25113 2.111785650253296
85 25113 3.940904140472412
86 25113 3.278371572494507
87 25113 3.412010669708252
88 25113 2.594789743423462
89 25113 3.132150173187256
90 25113 3.0704338550567627
91 25113 3.2131214141845703
92 25113 3.2693541049957275
93 25113 2.736027717590332
94 25113 3.4704575538635254
95 25113 2.843320369720459
96 25113 3.0639336109161377
97 25113 3.02590012550354
98 25113 2.0286083221435547
99 25113 4.572971820831299
100 25113 4.676558494567871
101 25113 2.3582167625427246
102 25113 2.888502836227417
103 25113 2.5010766983032227
104 25113 3.2154746055603027
105 25113 4.1159892082214355
106 25113 5.303995132446289
107 25113 3.733701705932617
108 25113 2.6910409927368164
109 25113 4.0442633628845215
110 25113 2.5786397457122803
111 25113 3.9990079402923584
112 25113 2.7006006240844727
113 25113 2.778020143508911
114 25113 2.3697564601898193
115 25113 1.9416426420211792
116 25113 4.5537519454956055
117 25113 2.3034355640411377
118 25113 2.5329980850219727
119 25113 3.021409511566162
120 25113 2.684530258178711
121 25113 2.330692768096924
122 25113 1.9723578691482544
123 25113 2.1068027019500732
124 25113 3.2476134300231934
125 25113 3.529151678085327
126 25113 3.1820082664489746
127 25113 2.500370740890503
128 25113 1.9617782831192017
129 25113 2.425781726837158
130 25113 3.0884997844696045
131 25113 1.8945932388305664
132 25113 2.2270700931549072
133 25113 2.6009936332702637
134 25113 2.607699394226074
135 25113 2.992666721343994
136 25113 1.8386313915252686
137 25113 2.1239876747131348
138 25113 0.8244442343711853
139 25113 1.974852442741394
140 25113 1.881534218788147
141 25113 1.262717366218567
142 25113 3.1078851222991943
143 25113 2.00058913230896
144 25113 1.7882548570632935
145 25113 1.3652244806289673
146 25113 1.4584611654281616
147 25113 1.2716591358184814
148 25113 1.9676659107208252
149 25113 2.0938358306884766
150 25113 2.3689754009246826
151 25113 1.2871241569519043
152 25113 1.7321395874023438
153 25113 1.7043122053146362
154 25113 2.069488525390625
155 25113 2.5686137676239014
156 25113 2.796389102935791
157 25113 2.8881118297576904
158 25113 1.324721097946167
159 25113 2.1632938385009766
160 25113 2.0316717624664307
161 25113 1.9304031133651733
162 25113 1.9222453832626343
163 25113 2.5301051139831543
164 25113 2.661094903945923
165 25113 3.2549197673797607
166 25113 1.6294968128204346
167 25113 1.2711257934570312
168 25113 1.5869221687316895
169 25113 1.6044784784317017
170 25113 1.4057849645614624
171 25113 2.6113197803497314
172 25113 1.3202593326568604
173 25113 1.8844153881072998
174 25113 3.0800485610961914
175 25113 1.8598979711532593
176 25113 1.2743754386901855
177 25113 1.8051862716674805
178 25113 2.001187801361084
179 25113 1.056262493133545
180 25113 1.417608380317688
181 25113 1.3113062381744385
182 25113 0.8558353185653687
183 25113 1.4033881425857544
184 25113 0.9606828093528748
185 25113 1.4427481889724731
186 25113 1.6556262969970703
187 25113 1.2766778469085693
188 25113 2.785456657409668
189 25113 1.9558600187301636
190 25113 2.065000057220459
191 25113 1.0727678537368774
192 25113 1.1838880777359009
193 25113 1.1930277347564697
194 25113 2.45577335357666
195 25113 0.8088322877883911
196 25113 2.4659178256988525
197 25113 1.685426950454712
198 25113 1.1113651990890503
199 25113 1.1422346830368042
200 25113 0.773691713809967
201 25113 1.2956392765045166
202 25113 1.4687188863754272
203 25113 1.3647994995117188
204 25113 1.2777256965637207
205 25113 1.3884369134902954
206 25113 1.430190920829773
207 25113 1.1327482461929321
208 25113 1.4239965677261353
209 25113 2.002514123916626
210 25113 1.3667540550231934
211 25113 1.3549784421920776
212 25113 1.3348256349563599
213 25113 1.654195785522461
214 25113 2.189629316329956
215 25113 2.143643856048584
216 25113 1.035544753074646
217 25113 1.121914267539978
218 25113 1.56723952293396
219 25113 1.767691731452942
220 25113 1.5032490491867065
221 25113 1.3082112073898315
222 25113 0.884380578994751
223 25113 1.5453095436096191
224 25113 1.2709670066833496
225 25113 1.1217219829559326
226 25113 0.4837219715118408
227 25113 0.4419497549533844
228 25113 2.155233383178711
229 25113 1.7572358846664429
230 25113 0.888594388961792
231 25113 1.0416455268859863
232 25113 0.7895844578742981
233 25113 1.002966046333313
234 25113 1.583818793296814
235 25113 2.1131691932678223
236 25113 1.26542067527771
237 25113 1.2346742153167725
238 25113 1.809979796409607
239 25113 2.250380277633667
240 25113 0.9033677577972412
241 25113 1.079080581665039
242 25113 0.9071158170700073
243 25113 1.3783680200576782
244 25113 1.9557971954345703
245 25113 0.7522858381271362
246 25113 1.454170823097229
247 25113 0.5709022283554077
248 25113 0.852636456489563
249 25113 0.5340145826339722
250 25113 0.7690138816833496
251 25113 0.4494765102863312
252 25113 0.5997177362442017
253 25113 0.9305770397186279
254 25113 1.4851105213165283
255 25113 0.8604097962379456
256 25113 1.1864566802978516
257 25113 1.2122776508331299
258 25113 0.8797067403793335
259 25113 1.3125497102737427
260 25113 0.676949679851532
261 25113 0.6399818658828735
train - Global loss: 2.460609    Embedding norm: 7.5763   Triplets (all/active): 95.9/5066.2
Pos dist (min/mean/max): 6.3431/10.4753/17.0590   Neg dist (min/mean/max): 7.0516/13.3932/25.0699
0 1011 0.6652772426605225
1 1011 1.0774940252304077
2 1011 0.5763095021247864
3 1011 1.3190720081329346
4 1011 2.0606157779693604
5 1011 1.5939829349517822
6 1011 0.8035789728164673
7 1011 1.0937230587005615
8 1011 1.1853300333023071
9 1011 4.236081123352051
10 1011 3.8348560333251953
val - Global loss: 1.676938    Embedding norm: 9.6148   Triplets (all/active): 91.9/4864.5
Pos dist (min/mean/max): 2.0071/4.1104/8.7104   Neg dist (min/mean/max): 2.1251/6.1179/17.4885
0 25113 0.994827926158905
1 25113 1.5456739664077759
2 25113 0.28689607977867126
3 25113 0.4453178942203522
4 25113 0.4406798779964447
5 25113 0.5135012865066528
6 25113 0.45667269825935364
7 25113 0.51882404088974
8 25113 0.5339040756225586
9 25113 1.2657135725021362
10 25113 0.4505316913127899
11 25113 0.6394535303115845
12 25113 1.5336202383041382
13 25113 0.6112353801727295
14 25113 1.5502381324768066
15 25113 0.3169519305229187
16 25113 0.30264511704444885
17 25113 0.6669059991836548
18 25113 0.7661144733428955
19 25113 1.2486510276794434
20 25113 0.5874935984611511
21 25113 0.28826776146888733
22 25113 0.2026693969964981
23 25113 0.298546701669693
24 25113 1.5246329307556152
25 25113 1.0919723510742188
26 25113 1.2030761241912842
27 25113 1.2823047637939453
28 25113 0.6736592650413513
29 25113 0.4997597634792328
30 25113 0.17262208461761475
31 25113 0.496163547039032
32 25113 0.30872100591659546
33 25113 0.5516966581344604
34 25113 1.0528825521469116
35 25113 0.22111955285072327
36 25113 0.49333974719047546
37 25113 0.8352219462394714
38 25113 0.5054746866226196
39 25113 0.8326042294502258
40 25113 0.70293128490448
41 25113 1.3053779602050781
42 25113 1.73757004737854
43 25113 0.3305223882198334
44 25113 0.6423531174659729
45 25113 1.1528730392456055
46 25113 0.8117956519126892
47 25113 0.3257754445075989
48 25113 0.5904101133346558
49 25113 0.5158326625823975
50 25113 0.7888674139976501
51 25113 0.4660411477088928
52 25113 0.20377102494239807
53 25113 0.6560747623443604
54 25113 0.3943174183368683
55 25113 0.15835949778556824
56 25113 0.5151345729827881
57 25113 0.64898282289505
58 25113 2.004948854446411
59 25113 0.8970509171485901
60 25113 0.797559380531311
61 25113 0.867711067199707
62 25113 0.5524680614471436
63 25113 0.555741012096405
64 25113 1.042859435081482
65 25113 0.45340272784233093
66 25113 0.346261203289032
67 25113 0.4208003282546997
68 25113 0.7290427684783936
69 25113 2.011148452758789
70 25113 1.2043968439102173
71 25113 2.015228033065796
72 25113 0.3896925449371338
73 25113 0.08731435984373093
74 25113 0.7398012280464172
75 25113 1.2057968378067017
76 25113 0.8458861112594604
77 25113 0.36566320061683655
78 25113 0.39597612619400024
79 25113 1.2118327617645264
80 25113 0.2625536024570465
81 25113 0.3175930678844452
82 25113 0.3002406358718872
83 25113 0.36207857728004456
84 25113 1.251993179321289
85 25113 0.4205397367477417
86 25113 0.23069709539413452
87 25113 0.9295817613601685
88 25113 0.4676625728607178
89 25113 0.8405969738960266
90 25113 0.9080525040626526
91 25113 1.1518970727920532
92 25113 0.702259361743927
93 25113 0.33723902702331543
94 25113 0.7955543994903564
95 25113 0.8823973536491394
96 25113 0.2981734275817871
97 25113 0.45495474338531494
98 25113 0.2201792299747467
99 25113 0.7130134701728821
100 25113 0.3524427115917206
101 25113 0.27322760224342346
102 25113 0.17922396957874298
103 25113 0.2851748764514923
104 25113 0.5624148845672607
105 25113 0.40297117829322815
106 25113 0.6112655401229858
107 25113 0.45512038469314575
108 25113 0.2498224526643753
109 25113 0.13107584416866302
110 25113 0.18870408833026886
111 25113 0.47893407940864563
112 25113 0.6811416745185852
113 25113 0.4155437648296356
114 25113 0.26647746562957764
115 25113 0.2458053082227707
116 25113 1.8628814220428467
117 25113 1.1971949338912964
118 25113 3.349825143814087
119 25113 0.8930106163024902
120 25113 0.4006040394306183
121 25113 0.3048069477081299
122 25113 0.4995436668395996
123 25113 0.2966335713863373
124 25113 1.042723536491394
125 25113 0.8497879505157471
126 25113 0.8045479655265808
127 25113 0.7112283706665039
128 25113 0.3369824290275574
129 25113 0.380113422870636
130 25113 0.30740848183631897
131 25113 0.3417677581310272
132 25113 0.29146525263786316
133 25113 0.4188686013221741
134 25113 0.6788696646690369
135 25113 0.13085822761058807
136 25113 0.30418917536735535
137 25113 0.18982693552970886
138 25113 0.3033464550971985
139 25113 0.14726755023002625
140 25113 0.7507928609848022
141 25113 0.19426538050174713
142 25113 0.3398838937282562
143 25113 0.4762885570526123
144 25113 0.20646816492080688
145 25113 0.2895403504371643
146 25113 0.29870396852493286
147 25113 0.18603098392486572
148 25113 0.25283145904541016
149 25113 0.6468520760536194
150 25113 0.6101430058479309
151 25113 0.31805312633514404
152 25113 0.47137513756752014
153 25113 0.4307849109172821
154 25113 0.25392159819602966
155 25113 1.1167254447937012
156 25113 1.0897243022918701
157 25113 0.34362295269966125
158 25113 0.3519498109817505
159 25113 0.6917113661766052
160 25113 0.30634042620658875
161 25113 0.7133470773696899
162 25113 0.21725915372371674
163 25113 0.20186446607112885
164 25113 1.0755029916763306
165 25113 0.19937703013420105
166 25113 0.4907430410385132
167 25113 0.3602675497531891
168 25113 0.8204246163368225
169 25113 1.244433879852295
170 25113 0.3490734100341797
171 25113 1.5787748098373413
172 25113 0.2947807013988495
173 25113 0.8918311595916748
174 25113 2.080509662628174
175 25113 0.8598134517669678
176 25113 0.38512271642684937
177 25113 0.9708718061447144
178 25113 0.9963899254798889
179 25113 0.25445231795310974
180 25113 0.38052356243133545
181 25113 0.2853558659553528
182 25113 0.05626973882317543
183 25113 0.6296404004096985
184 25113 0.22633439302444458
185 25113 0.6064548492431641
186 25113 0.3806074559688568
187 25113 0.30574724078178406
188 25113 0.657041072845459
189 25113 0.31398773193359375
190 25113 0.7026153802871704
191 25113 0.33364781737327576
192 25113 0.1976349800825119
193 25113 0.5882908701896667
194 25113 0.7071107029914856
195 25113 0.4628988206386566
196 25113 0.7791837453842163
197 25113 0.32735005021095276
198 25113 0.41184553503990173
199 25113 0.684570848941803
200 25113 0.16033750772476196
201 25113 0.4513271152973175
202 25113 0.6003437042236328
203 25113 0.3205212354660034
204 25113 0.2890315651893616
205 25113 0.3294343054294586
206 25113 0.6229219436645508
207 25113 0.5479071140289307
208 25113 1.2003570795059204
209 25113 0.3694455921649933
210 25113 0.35334664583206177
211 25113 0.7669618725776672
212 25113 0.4152071475982666
213 25113 1.3603765964508057
214 25113 1.2888562679290771
215 25113 0.831038236618042
216 25113 0.8928786516189575
217 25113 0.22014248371124268
218 25113 0.8255943059921265
219 25113 0.7539891004562378
220 25113 0.48828476667404175
221 25113 0.46049124002456665
222 25113 0.4034789800643921
223 25113 0.8183197975158691
224 25113 0.55924391746521
225 25113 0.5296986103057861
226 25113 0.17377083003520966
227 25113 0.3129560351371765
228 25113 1.116500735282898
229 25113 0.9318807721138
230 25113 0.604279637336731
231 25113 0.7110268473625183
232 25113 0.4903402030467987
233 25113 1.126378059387207
234 25113 0.5519092082977295
235 25113 1.2286176681518555
236 25113 1.0152275562286377
237 25113 0.3383101224899292
238 25113 0.7733686566352844
239 25113 0.7998451590538025
240 25113 0.25821834802627563
241 25113 0.5071835517883301
242 25113 0.19985847175121307
243 25113 0.49818146228790283
244 25113 0.8347537517547607
245 25113 0.24372035264968872
246 25113 0.26577767729759216
247 25113 0.15658332407474518
248 25113 0.6156424283981323
249 25113 0.474403977394104
250 25113 0.30453091859817505
251 25113 0.27719321846961975
252 25113 0.618587076663971
253 25113 0.3506275415420532
254 25113 0.6373785138130188
255 25113 0.4821644425392151
256 25113 0.4556913673877716
257 25113 0.5782281756401062
258 25113 0.6181190013885498
259 25113 0.4008219838142395
260 25113 0.7993059158325195
261 25113 0.2693215310573578
train - Global loss: 0.616400    Embedding norm: 1.4941   Triplets (all/active): 95.9/2447.4
Pos dist (min/mean/max): 1.0576/2.1383/3.8742   Neg dist (min/mean/max): 1.8426/4.2086/8.2141
0 1011 0.48384562134742737
1 1011 0.5048485398292542
2 1011 0.31530898809432983
3 1011 0.3637864291667938
4 1011 1.3944629430770874
5 1011 1.0256257057189941
6 1011 0.49031156301498413
7 1011 0.4656389355659485
8 1011 0.43835270404815674
9 1011 2.110001802444458
10 1011 1.8970985412597656
val - Global loss: 0.862662    Embedding norm: 7.8027   Triplets (all/active): 91.9/5979.6
Pos dist (min/mean/max): 0.6984/1.5891/3.2237   Neg dist (min/mean/max): 0.7542/2.4984/5.8866
0 25113 0.29556891322135925
1 25113 1.008333444595337
2 25113 0.16181117296218872
3 25113 0.13714206218719482
4 25113 0.32114464044570923
5 25113 0.30788278579711914
6 25113 0.23593179881572723
7 25113 0.31132015585899353
8 25113 0.3169015944004059
9 25113 0.4570547342300415
10 25113 0.12805286049842834
11 25113 0.29521605372428894
12 25113 0.43524208664894104
13 25113 0.2304612398147583
14 25113 0.3621254861354828
15 25113 0.1264898180961609
16 25113 0.16871806979179382
17 25113 0.43124085664749146
18 25113 0.6068664193153381
19 25113 0.40145227313041687
20 25113 0.5949416160583496
21 25113 0.20607700943946838
22 25113 0.15254899859428406
23 25113 0.16116201877593994
24 25113 0.7752674221992493
25 25113 0.8052253723144531
26 25113 0.5962615609169006
27 25113 0.21752816438674927
28 25113 0.2921782433986664
29 25113 0.31012558937072754
30 25113 0.22638343274593353
31 25113 0.18185436725616455
32 25113 0.27170032262802124
33 25113 0.49483028054237366
34 25113 0.7666879892349243
35 25113 0.359404593706131
36 25113 0.45817896723747253
37 25113 0.29591038823127747
38 25113 0.37001973390579224
39 25113 0.6541175246238708
40 25113 0.834428071975708
41 25113 0.941643238067627
42 25113 2.2403411865234375
43 25113 0.0
44 25113 0.5743273496627808
45 25113 0.7753671407699585
46 25113 1.0129297971725464
47 25113 0.3352429270744324
48 25113 0.4228421151638031
49 25113 0.323918879032135
50 25113 0.34869861602783203
51 25113 0.3454114496707916
52 25113 0.05295746028423309
53 25113 0.21615414321422577
54 25113 0.3443230986595154
55 25113 0.03392920643091202
56 25113 0.20372556149959564
57 25113 0.20074811577796936
58 25113 0.42478105425834656
59 25113 0.12979693710803986
60 25113 0.24509190022945404
61 25113 0.33629465103149414
62 25113 0.1622740477323532
63 25113 0.11012380570173264
64 25113 0.08939862996339798
65 25113 0.5005860924720764
66 25113 0.2261979579925537
67 25113 0.19223730266094208
68 25113 0.2078801542520523
69 25113 1.1639043092727661
70 25113 0.9531846046447754
71 25113 1.704342246055603
72 25113 0.06829441338777542
73 25113 0.47979217767715454
74 25113 0.47056615352630615
75 25113 0.5536894798278809
76 25113 0.5896029472351074
77 25113 0.16225683689117432
78 25113 0.35328638553619385
79 25113 0.44791704416275024
80 25113 0.10663604736328125
81 25113 0.10258982330560684
82 25113 0.13691706955432892
83 25113 0.08506134897470474
84 25113 1.1237443685531616
85 25113 0.31356096267700195
86 25113 0.24754738807678223
87 25113 0.9153896570205688
88 25113 0.3153444230556488
89 25113 1.2154897451400757
90 25113 0.778907060623169
91 25113 1.1836029291152954
92 25113 1.2565197944641113
93 25113 0.37214791774749756
94 25113 0.6932231187820435
95 25113 0.7024794816970825
96 25113 0.2223881185054779
97 25113 0.514853298664093
98 25113 0.3856252133846283
99 25113 0.4695204198360443
100 25113 0.21335849165916443
101 25113 0.18479576706886292
102 25113 0.1086135134100914
103 25113 0.10732809454202652
104 25113 0.37465015053749084
105 25113 0.31339457631111145
106 25113 0.2675137519836426
107 25113 0.14964941143989563
108 25113 0.07243317365646362
109 25113 0.0
110 25113 0.2536194920539856
111 25113 0.4536309540271759
112 25113 0.902798593044281
113 25113 0.18270523846149445
114 25113 0.12481926381587982
115 25113 0.22535356879234314
116 25113 1.409569263458252
117 25113 0.16214680671691895
118 25113 1.4883297681808472
119 25113 0.8751140236854553
120 25113 0.22711583971977234
121 25113 0.2923087775707245
122 25113 0.3982563316822052
123 25113 0.4280816912651062
124 25113 0.8127114176750183
125 25113 0.3565411865711212
126 25113 0.5932468175888062
127 25113 0.7894197106361389
128 25113 0.23884446918964386
129 25113 0.5646320581436157
130 25113 0.5102356672286987
131 25113 0.19832760095596313
132 25113 0.09622450172901154
133 25113 0.46382641792297363
134 25113 0.7532762289047241
Traceback (most recent call last):
  File "/code/RLoc/training/train.py", line 31, in <module>
    do_train(params, debug=args.debug, device=device)
  File "/code/RLoc/training/trainer.py", line 408, in do_train
    torch.cuda.empty_cache()
  File "/usr/local/lib/python3.9/site-packages/torch/cuda/memory.py", line 121, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
