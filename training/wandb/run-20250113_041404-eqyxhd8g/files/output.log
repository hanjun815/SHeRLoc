  0%|                                                                               | 0/120 [00:00<?, ?it/s]
0 74984 0.984102725982666
1 74984 0.4085741639137268
2 74984 0.7961679100990295
3 74984 0.4031004309654236
4 74984 0.6813396215438843
5 74984 0.5459182858467102
6 74984 0.4247279465198517
7 74984 0.41291478276252747
8 74984 0.34646397829055786
9 74984 0.18563266098499298
10 74984 0.22195735573768616
11 74984 0.1344975233078003
12 74984 0.340048223733902
13 74984 0.1477029025554657
14 74984 0.45218420028686523
15 74984 0.6374828219413757
16 74984 0.9823336601257324
17 74984 0.21747523546218872
18 74984 0.23591049015522003
19 74984 0.23077388107776642
20 74984 0.1537007987499237
21 74984 0.49194011092185974
22 74984 0.7849293351173401
23 74984 0.18848086893558502
24 74984 0.28000980615615845
25 74984 0.1974949836730957
26 74984 0.31610581278800964
27 74984 0.17454218864440918
28 74984 0.232111394405365
29 74984 0.1425144225358963
30 74984 0.0
31 74984 0.0
32 74984 0.4689275324344635
33 74984 0.17746856808662415
34 74984 0.0
35 74984 0.0
36 74984 0.2643685042858124
37 74984 0.0
38 74984 0.0
39 74984 0.0
40 74984 0.17027683556079865
41 74984 0.1114170104265213
42 74984 0.2615492343902588
43 74984 0.45936521887779236
44 74984 0.0
45 74984 0.0
46 74984 0.2665097713470459
47 74984 0.017013147473335266
48 74984 0.0
49 74984 0.0
50 74984 0.0
51 74984 0.0
52 74984 0.0
53 74984 0.0
54 74984 0.40510377287864685
55 74984 0.4620010256767273
56 74984 0.4347683787345886
57 74984 0.0
58 74984 0.0
59 74984 0.4629670977592468
60 74984 0.0
61 74984 0.0
62 74984 0.0
63 74984 0.0
64 74984 0.14975948631763458
65 74984 0.0
66 74984 0.0
67 74984 0.0
68 74984 0.0
69 74984 0.0
70 74984 0.0
71 74984 0.0
72 74984 0.0
73 74984 0.0
74 74984 0.0
75 74984 0.0
76 74984 0.0
77 74984 0.0
78 74984 0.0
79 74984 0.0
80 74984 0.0
81 74984 0.0
82 74984 0.0
83 74984 0.0
84 74984 0.0
85 74984 0.0
86 74984 0.0
87 74984 0.0
88 74984 0.0
89 74984 0.0
90 74984 0.0
91 74984 0.0
92 74984 0.0
93 74984 0.0
94 74984 0.0
95 74984 0.0
96 74984 0.0
97 74984 0.0
98 74984 0.0
99 74984 0.0
100 74984 0.0
101 74984 0.0
102 74984 0.0
103 74984 0.0
104 74984 0.0
105 74984 0.07442532479763031
106 74984 0.0
107 74984 0.04067249596118927
108 74984 0.0
109 74984 0.512748658657074
110 74984 0.0
111 74984 0.0
112 74984 0.0
113 74984 0.0
114 74984 0.0
115 74984 0.0
116 74984 0.0
117 74984 0.0
118 74984 0.0
119 74984 0.6656539440155029
120 74984 0.0
121 74984 0.0
122 74984 0.0
123 74984 0.0
124 74984 0.0
125 74984 0.0
126 74984 0.0
127 74984 0.0
128 74984 0.0
129 74984 0.0
130 74984 0.0
131 74984 0.035404399037361145
132 74984 0.0
133 74984 0.0
134 74984 0.0
135 74984 1.138922929763794
136 74984 0.004237368702888489
137 74984 0.285439670085907
138 74984 0.0
139 74984 0.0
140 74984 0.6199540495872498
141 74984 0.0
142 74984 0.0
143 74984 0.0
144 74984 0.0
145 74984 0.0
146 74984 0.0
147 74984 4.1548261642456055
148 74984 0.0
149 74984 0.6153600215911865
150 74984 0.0
151 74984 0.0
152 74984 0.6345040202140808
153 74984 0.7820292711257935
154 74984 0.0
155 74984 0.0
156 74984 0.0
157 74984 0.0
158 74984 0.0
159 74984 0.0
160 74984 0.0
161 74984 0.0
162 74984 0.0
163 74984 0.0
164 74984 0.4119839370250702
165 74984 0.0
166 74984 0.0
167 74984 0.0
168 74984 0.5411691069602966
169 74984 1.0797770023345947
170 74984 0.0
171 74984 0.0
172 74984 0.0
173 74984 1.9736614227294922
174 74984 0.0
175 74984 0.0
176 74984 0.0
177 74984 0.0
178 74984 0.0
179 74984 0.0
180 74984 0.0
181 74984 0.0
182 74984 0.0
183 74984 0.0
184 74984 0.0
185 74984 0.0
186 74984 0.0
187 74984 0.0
188 74984 0.0
189 74984 0.0
190 74984 0.0
191 74984 2.9368386268615723
192 74984 1.286965012550354
193 74984 0.0
194 74984 0.0
195 74984 0.0
196 74984 0.0
197 74984 0.0
198 74984 0.4297311007976532
199 74984 0.0
200 74984 0.0
201 74984 0.0
202 74984 0.0
203 74984 0.0
204 74984 0.0
205 74984 0.0
206 74984 0.0
207 74984 0.0
208 74984 0.0
209 74984 0.0
210 74984 0.0
211 74984 0.0
212 74984 0.0
213 74984 0.0
214 74984 0.0
215 74984 0.0
216 74984 0.48842576146125793
217 74984 0.2670019865036011
218 74984 0.0
219 74984 0.6092759966850281
220 74984 0.0
221 74984 0.0
222 74984 0.0
223 74984 0.0
224 74984 0.0
225 74984 0.0
226 74984 0.0
227 74984 0.0
228 74984 0.0
229 74984 0.0
230 74984 0.0
231 74984 0.0
232 74984 0.0
233 74984 0.0
234 74984 0.0
235 74984 0.0
236 74984 0.0
237 74984 0.0
238 74984 0.0
239 74984 0.0
240 74984 0.0
241 74984 0.0
242 74984 0.0
243 74984 0.0
244 74984 0.0
245 74984 0.0
246 74984 0.0
247 74984 0.0
248 74984 0.7817068696022034
249 74984 0.6088506579399109
250 74984 0.0
251 74984 0.0
252 74984 0.0
253 74984 1.7804924249649048
254 74984 0.0
255 74984 0.0
256 74984 0.0
257 74984 0.0
258 74984 0.1486026793718338
259 74984 0.0
260 74984 2.4905290603637695
261 74984 1.6878069639205933
262 74984 0.0
263 74984 0.0
264 74984 1.2255803346633911
265 74984 0.0
266 74984 0.0
267 74984 0.0
268 74984 0.0
269 74984 0.0
270 74984 0.0
271 74984 0.7682079076766968
272 74984 0.0
273 74984 0.0
274 74984 0.0
275 74984 2.310204267501831
276 74984 1.5165303945541382
277 74984 0.16682180762290955
278 74984 0.0
279 74984 0.0
280 74984 0.0
281 74984 0.0
282 74984 0.0
283 74984 0.6632227897644043
284 74984 0.22195476293563843
285 74984 0.0
286 74984 0.0
287 74984 0.0
288 74984 0.0
289 74984 0.0
290 74984 0.2945581376552582
291 74984 0.0
292 74984 0.0
293 74984 0.6332798004150391
294 74984 0.0
295 74984 0.2302839308977127
296 74984 0.562455952167511
297 74984 0.0
298 74984 0.0
299 74984 1.0175365209579468
300 74984 0.0
301 74984 0.0
302 74984 0.0
303 74984 0.0
304 74984 0.0
305 74984 0.0
306 74984 0.0
307 74984 0.9623118042945862
308 74984 0.0
309 74984 0.0
310 74984 0.0
311 74984 0.0
312 74984 2.3514888286590576
313 74984 0.6225455403327942
314 74984 0.0
315 74984 0.0
316 74984 0.0
317 74984 0.0
318 74984 0.0
319 74984 0.9939389228820801
320 74984 0.0
321 74984 0.0
322 74984 0.0
323 74984 0.0
324 74984 0.0
325 74984 3.982165813446045
326 74984 0.7315046191215515
327 74984 13.576005935668945
328 74984 0.0
329 74984 0.0
330 74984 0.0
331 74984 0.0
332 74984 1.0439754724502563
333 74984 0.3158399164676666
334 74984 0.19727320969104767
335 74984 0.0
336 74984 0.0
337 74984 0.0
338 74984 0.0
339 74984 0.0
340 74984 0.0
341 74984 0.0
342 74984 0.0
343 74984 0.0
344 74984 0.0
345 74984 0.0
346 74984 0.0
347 74984 0.0
348 74984 0.0
349 74984 0.0
350 74984 0.0
351 74984 0.0
352 74984 0.0
353 74984 0.0
354 74984 0.0
355 74984 0.0
356 74984 0.0
357 74984 0.0
358 74984 0.0
359 74984 0.0
360 74984 0.0
361 74984 0.0
362 74984 0.0
363 74984 0.0
364 74984 0.0
365 74984 0.0
366 74984 0.0
367 74984 0.0
368 74984 0.0
369 74984 0.0
370 74984 0.0
371 74984 0.0
372 74984 0.0
373 74984 0.0
374 74984 0.0
375 74984 0.0
376 74984 0.0
377 74984 0.0
378 74984 0.49362120032310486
379 74984 0.0
380 74984 0.15567880868911743
381 74984 0.0
382 74984 0.0
383 74984 0.0
384 74984 0.0
385 74984 0.0
386 74984 0.0
387 74984 0.0
388 74984 0.7307102084159851
389 74984 0.0
390 74984 0.0
391 74984 0.0
392 74984 0.0
393 74984 0.0
394 74984 0.0
395 74984 0.0
396 74984 0.0
397 74984 0.0
398 74984 0.0
399 74984 0.0
400 74984 0.0
401 74984 0.0
402 74984 0.0
403 74984 0.6548067331314087
404 74984 2.6277828216552734
405 74984 0.0
406 74984 0.0
407 74984 0.0
408 74984 0.9417628049850464
409 74984 0.23799939453601837
410 74984 0.0
411 74984 1.8264853954315186
412 74984 0.0
413 74984 0.0
414 74984 0.0
415 74984 0.0
416 74984 0.0
417 74984 0.0
418 74984 0.0
419 74984 0.0
420 74984 0.0
421 74984 0.0
422 74984 0.0
423 74984 0.0
424 74984 0.0
425 74984 0.0
426 74984 0.0
427 74984 0.0
428 74984 0.0
429 74984 0.0
430 74984 0.0
431 74984 0.0
432 74984 0.0
433 74984 0.0
434 74984 0.0
435 74984 0.0
436 74984 0.40721461176872253
437 74984 0.0
438 74984 0.0
439 74984 0.0
440 74984 0.7173824310302734
441 74984 0.6725794076919556
442 74984 0.0
443 74984 0.0
444 74984 0.0
445 74984 0.0
446 74984 0.0
447 74984 0.0
448 74984 0.0
449 74984 0.0
450 74984 0.0
451 74984 0.0
452 74984 0.0
453 74984 0.634450376033783
454 74984 0.0
455 74984 0.0
456 74984 0.0
457 74984 0.0
458 74984 0.0
459 74984 0.0
460 74984 0.0
461 74984 0.0
462 74984 0.0
463 74984 0.0
464 74984 0.0
465 74984 0.0
466 74984 1.0557399988174438
467 74984 0.0
468 74984 0.0
469 74984 0.0
470 74984 0.0
471 74984 0.0
472 74984 0.0
473 74984 0.0
474 74984 0.0
475 74984 0.0
476 74984 0.0
477 74984 0.0
478 74984 0.0
479 74984 0.0
480 74984 0.0
481 74984 0.0
482 74984 0.0
483 74984 0.0
484 74984 0.0
485 74984 0.0
486 74984 0.0
487 74984 0.0
488 74984 0.0
489 74984 0.0
490 74984 1.0204639434814453
491 74984 0.0
492 74984 0.0
493 74984 0.0
494 74984 0.0
495 74984 0.0
496 74984 0.0
497 74984 0.5866269469261169
498 74984 0.5948712229728699
499 74984 0.0
train - Global loss: 0.181391    Embedding norm: 39.2005   Triplets (all/active): 150.0/11.1
Pos dist (min/mean/max): 2.8187/5.5350/9.4775   Neg dist (min/mean/max): 7.4038/11.7757/16.6588
0 2857 0.4389401376247406
1 2857 0.6158731579780579
2 2857 0.6697837114334106
3 2857 0.6636929512023926
4 2857 0.8316866755485535
5 2857 0.6063190698623657
6 2857 0.607310950756073
7 2857 0.505379319190979
8 2857 0.7135467529296875
9 2857 1.2043747901916504
10 2857 0.7394707798957825
11 2857 0.8169499635696411
12 2857 0.7520710229873657
13 2857 0.8252052664756775
14 2857 0.5486419200897217
15 2857 0.49884167313575745
16 2857 0.5430788397789001
17 2857 0.3961906433105469
18 2857 0.46049734950065613
19 2857 0.5354673862457275
val - Global loss: 0.648666    Embedding norm: 48.7976   Triplets (all/active): 142.8/142.6
Pos dist (min/mean/max): 1.2083/2.1629/3.6138   Neg dist (min/mean/max): 1.1534/2.2516/4.0545
0 74984 0.0
1 74984 0.0
2 74984 0.6274735927581787
3 74984 0.0
4 74984 0.0
5 74984 0.0
6 74984 0.0
7 74984 0.0
8 74984 0.0
9 74984 0.0
10 74984 0.0
11 74984 0.0
12 74984 0.0
13 74984 0.0
14 74984 0.0
15 74984 0.0
16 74984 0.242961585521698
17 74984 0.0
18 74984 0.0
19 74984 0.0
20 74984 0.0
21 74984 0.0
22 74984 0.42136210203170776
23 74984 0.0
24 74984 0.11092396080493927
25 74984 0.0
26 74984 0.39146536588668823
27 74984 0.0
28 74984 0.0
29 74984 0.0
30 74984 0.0
31 74984 0.0
32 74984 0.0
33 74984 0.0
34 74984 0.0
35 74984 0.0
36 74984 2.228422164916992
37 74984 0.0
38 74984 0.0
39 74984 0.0
40 74984 0.0
41 74984 0.0
42 74984 0.0
43 74984 0.0
44 74984 0.0
45 74984 0.0
46 74984 0.0
47 74984 0.0
48 74984 0.0
49 74984 0.0
50 74984 0.0
51 74984 0.0
52 74984 0.0
53 74984 0.0
54 74984 0.0
55 74984 0.0
56 74984 0.0
57 74984 0.0
58 74984 0.0
59 74984 0.0
60 74984 0.0
61 74984 0.0
62 74984 0.0
63 74984 0.0
64 74984 0.0
65 74984 0.0
66 74984 0.0
67 74984 0.0
68 74984 0.0
69 74984 0.0
70 74984 0.0
71 74984 0.0
72 74984 0.0
73 74984 0.0
74 74984 0.0
75 74984 0.0
76 74984 0.0
77 74984 0.0
78 74984 0.0
79 74984 0.0
80 74984 0.0
81 74984 0.0
82 74984 0.0
83 74984 0.0
84 74984 0.0
85 74984 0.0
86 74984 0.0
87 74984 0.0
88 74984 0.0
89 74984 0.0
90 74984 0.0
91 74984 0.0
92 74984 0.0
93 74984 0.0
94 74984 0.0
95 74984 0.9195443987846375
96 74984 0.0
97 74984 0.0
98 74984 0.0
99 74984 0.0
100 74984 0.0
101 74984 0.0
102 74984 0.0
103 74984 0.0
104 74984 0.0
105 74984 0.9698034524917603
106 74984 0.0
107 74984 0.0
108 74984 0.0
109 74984 0.0
110 74984 0.0
111 74984 0.0
112 74984 0.0
113 74984 0.0
114 74984 0.0
115 74984 0.0
116 74984 0.0
117 74984 0.0
118 74984 0.0
119 74984 0.0
120 74984 0.0
121 74984 0.0
122 74984 0.0
123 74984 0.0
124 74984 0.0
125 74984 0.0
126 74984 0.0
127 74984 0.0
128 74984 0.0
129 74984 0.0
130 74984 0.0
131 74984 0.0
132 74984 0.0
133 74984 0.18724745512008667
134 74984 0.0
135 74984 1.7177350521087646
136 74984 0.0
137 74984 0.0
138 74984 0.0
139 74984 0.0
140 74984 0.0
141 74984 0.0
142 74984 0.0
143 74984 0.0
144 74984 0.0
145 74984 0.0
146 74984 0.0
147 74984 0.0
148 74984 0.0
149 74984 0.0
150 74984 0.0
151 74984 0.0
152 74984 0.0
153 74984 0.0
154 74984 0.0
155 74984 0.0
156 74984 0.0
157 74984 0.0
158 74984 0.0
159 74984 0.0
160 74984 0.0
161 74984 0.0
162 74984 0.0
163 74984 0.0
164 74984 0.0
165 74984 0.0
166 74984 0.0
167 74984 0.0
168 74984 1.158057451248169
169 74984 0.8024894595146179
170 74984 0.0
171 74984 0.0
172 74984 0.0
173 74984 0.0
174 74984 0.0
175 74984 0.0
176 74984 0.0
177 74984 0.0
178 74984 0.0
179 74984 0.0
180 74984 0.0
181 74984 0.0
182 74984 0.0
183 74984 0.0
184 74984 0.0
185 74984 0.0
186 74984 0.0
187 74984 0.0
188 74984 1.025430679321289
Traceback (most recent call last):
  File "/code/RLoc/training/train.py", line 31, in <module>
    do_train(params, debug=args.debug, device=device)
  File "/code/RLoc/training/trainer.py", line 356, in do_train
    for index, (query, positives, negatives) in enumerate(dataloaders[phase]):
  File "/usr/local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/usr/local/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/code/RLoc/training/dataset.py", line 102, in __getitem__
    neg = np.array(Image.open(neg_image_path)).astype(np.float32)
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 701, in __array_interface__
    new["data"] = self.tobytes()
  File "/usr/local/lib/python3.9/site-packages/PIL/Image.py", line 758, in tobytes
    self.load()
  File "/usr/local/lib/python3.9/site-packages/PIL/ImageFile.py", line 269, in load
    n, err_code = decoder.decode(b)
KeyboardInterrupt
