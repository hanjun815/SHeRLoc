  0%|                                                                             | 0/120 [00:00<?, ?it/s]
0 81028 2.701613426208496
1 81028 1.560079574584961
2 81028 1.2184163331985474
3 81028 1.9674936532974243
4 81028 2.1946845054626465
5 81028 1.2364543676376343
6 81028 1.901878833770752
7 81028 1.7345637083053589
8 81028 1.453190565109253
9 81028 1.554286003112793
10 81028 1.437221646308899
11 81028 1.1531389951705933
12 81028 1.592727541923523
13 81028 1.3801162242889404
14 81028 1.3799128532409668
15 81028 1.2908904552459717
16 81028 1.2063292264938354
17 81028 0.9037548303604126
18 81028 0.605074942111969
19 81028 1.0777082443237305
20 81028 0.7142606377601624
21 81028 0.6940445303916931
22 81028 0.9679536819458008
23 81028 0.567438006401062
24 81028 1.0854971408843994
25 81028 1.0652552843093872
26 81028 0.7221971154212952
27 81028 0.8612750768661499
28 81028 0.7907289266586304
29 81028 0.727385938167572
30 81028 0.44969940185546875
31 81028 0.5470945835113525
32 81028 0.538480818271637
33 81028 0.7532569766044617
34 81028 0.4256008267402649
35 81028 0.9599928259849548
36 81028 1.631982684135437
37 81028 0.6376850605010986
38 81028 0.45222827792167664
39 81028 0.4998297095298767
40 81028 0.5574374794960022
41 81028 0.5282102227210999
42 81028 0.4897001087665558
43 81028 0.9822790026664734
44 81028 0.5937337279319763
45 81028 0.48373445868492126
46 81028 0.6580663323402405
47 81028 0.6516489386558533
48 81028 0.45500648021698
49 81028 0.4650552272796631
50 81028 0.5374753475189209
51 81028 0.7592713236808777
52 81028 0.5681284070014954
53 81028 0.458923876285553
54 81028 0.562348484992981
55 81028 0.5887071490287781
56 81028 0.5905119776725769
57 81028 0.6161336898803711
58 81028 0.5530623197555542
59 81028 0.3849773108959198
60 81028 0.762791633605957
61 81028 1.0169042348861694
62 81028 0.8378809094429016
63 81028 0.4099576771259308
64 81028 0.5107342004776001
65 81028 0.4956696033477783
66 81028 0.5698575377464294
67 81028 0.5165593028068542
68 81028 0.5190413594245911
69 81028 0.4703099727630615
70 81028 0.5870054960250854
71 81028 0.41748037934303284
72 81028 0.43697604537010193
73 81028 0.3725179135799408
74 81028 0.5295279026031494
75 81028 0.4160006642341614
76 81028 0.4724332392215729
77 81028 0.4397684633731842
78 81028 0.3797183930873871
79 81028 0.3981361985206604
80 81028 0.40313029289245605
81 81028 0.4940478801727295
82 81028 0.38950663805007935
83 81028 0.44406214356422424
84 81028 0.4003361165523529
85 81028 0.41508159041404724
86 81028 0.3834882378578186
87 81028 0.4363011121749878
88 81028 0.5785823464393616
89 81028 0.6064082384109497
90 81028 0.6499781608581543
91 81028 0.3485933244228363
92 81028 0.33545032143592834
93 81028 0.4285314977169037
94 81028 0.6040582656860352
95 81028 0.34496018290519714
96 81028 0.735211968421936
97 81028 0.3852171301841736
98 81028 0.5645989179611206
99 81028 0.3849855065345764
100 81028 0.41412702202796936
101 81028 0.44570890069007874
102 81028 0.43576788902282715
103 81028 0.4699573516845703
104 81028 0.4296528697013855
105 81028 0.4488987326622009
106 81028 0.4096846580505371
107 81028 0.4079647958278656
108 81028 0.3548978567123413
109 81028 0.3733399212360382
110 81028 0.4183734357357025
111 81028 0.4292799234390259
112 81028 0.42981547117233276
113 81028 0.41074588894844055
114 81028 0.35255682468414307
115 81028 0.44896337389945984
116 81028 0.4016927480697632
117 81028 0.7065677642822266
118 81028 0.40194714069366455
119 81028 0.48215827345848083
120 81028 0.44378381967544556
121 81028 0.3717266321182251
122 81028 0.37234318256378174
123 81028 0.36778128147125244
124 81028 0.459277480840683
125 81028 0.5716060400009155
126 81028 0.7275248765945435
127 81028 0.3468469977378845
128 81028 0.3295154273509979
129 81028 0.35041823983192444
130 81028 0.305367112159729
131 81028 0.36952832341194153
132 81028 0.3814031183719635
133 81028 0.4430401623249054
134 81028 0.40025395154953003
135 81028 0.39070433378219604
136 81028 0.42822134494781494
137 81028 0.42914149165153503
138 81028 0.4952903985977173
139 81028 0.5070273280143738
140 81028 0.44164761900901794
141 81028 0.43529000878334045
142 81028 0.43145179748535156
143 81028 0.3860812485218048
144 81028 0.35133835673332214
145 81028 0.33416739106178284
146 81028 0.3714795410633087
147 81028 0.4768880009651184
148 81028 0.39717745780944824
149 81028 0.3125249445438385
150 81028 0.3328637182712555
151 81028 0.4259985685348511
152 81028 0.3616218566894531
153 81028 0.38006699085235596
154 81028 0.3176458477973938
155 81028 0.41037988662719727
156 81028 0.4064667820930481
157 81028 0.3689437508583069
158 81028 0.3188017010688782
train - Global loss: 0.631707    Embedding norm: 12.8344   Triplets (all/active): 509.6/258939.7
Pos dist (min/mean/max): 1.3908/1.9535/2.9629   Neg dist (min/mean/max): 1.3052/1.9572/3.6373
0 31777 0.5485097169876099
1 31777 0.6208525896072388
2 31777 0.5932899713516235
3 31777 0.41528353095054626
4 31777 0.47384291887283325
5 31777 0.4087145924568176
6 31777 0.3645555078983307
7 31777 0.46182167530059814
8 31777 0.4748016893863678
9 31777 0.38129928708076477
10 31777 0.37150901556015015
11 31777 0.46103134751319885
12 31777 0.7185102105140686
13 31777 0.7468135952949524
14 31777 0.6464400291442871
15 31777 0.4701288938522339
16 31777 0.49349093437194824
17 31777 0.6422751545906067
18 31777 0.7305349111557007
19 31777 0.6330112218856812
20 31777 0.6789792776107788
21 31777 0.4311691224575043
22 31777 0.3538690209388733
23 31777 0.38091161847114563
24 31777 0.3588062524795532
25 31777 0.4363757073879242
26 31777 0.4310479462146759
27 31777 0.42103704810142517
28 31777 0.45989200472831726
29 31777 0.47930634021759033
30 31777 0.4468283951282501
31 31777 0.47830596566200256
32 31777 0.47709816694259644
33 31777 0.4682852625846863
34 31777 0.5343825817108154
35 31777 0.4869082570075989
36 31777 0.40302711725234985
37 31777 0.3661871552467346
38 31777 0.5025091767311096
39 31777 0.5411278009414673
40 31777 0.6911078095436096
41 31777 0.6355482935905457
42 31777 0.64653480052948
43 31777 0.5724315643310547
44 31777 0.4687561094760895
45 31777 0.3692593574523926
46 31777 0.3820304274559021
47 31777 0.3493996560573578
48 31777 0.5403270721435547
49 31777 0.4349023401737213
50 31777 0.4473623037338257
51 31777 0.405049204826355
52 31777 0.4108402729034424
53 31777 0.4463871717453003
54 31777 0.46879106760025024
55 31777 0.45507729053497314
56 31777 0.47000980377197266
57 31777 0.5985057353973389
58 31777 0.5839455127716064
59 31777 0.5608632564544678
60 31777 0.5227918028831482
61 31777 0.49870437383651733
62 31777 0.6510655283927917
val - Global loss: 0.498452    Embedding norm: 12.1154   Triplets (all/active): 504.4/257813.4
Pos dist (min/mean/max): 1.3805/1.7170/2.1381   Neg dist (min/mean/max): 1.2680/1.7431/2.6312
0 81028 0.4247375428676605
1 81028 0.5192623138427734
2 81028 0.36780548095703125
3 81028 0.3699618875980377
4 81028 0.34149155020713806
5 81028 0.4196532964706421
6 81028 0.4309428036212921
7 81028 0.5141890048980713
8 81028 0.4011511206626892
9 81028 0.4083404541015625
10 81028 0.3062344193458557
11 81028 0.4213983416557312
12 81028 0.458191454410553
13 81028 0.42464426159858704
14 81028 0.39268913865089417
15 81028 0.43421417474746704
16 81028 0.3067532181739807
17 81028 0.42753690481185913
18 81028 0.37617549300193787
19 81028 0.28907567262649536
20 81028 0.3720414340496063
21 81028 0.3061470687389374
22 81028 0.40704771876335144
23 81028 0.3411293923854828
24 81028 0.4584018886089325
25 81028 0.4024960994720459
26 81028 0.4674379229545593
27 81028 0.3739463984966278
28 81028 0.42102596163749695
29 81028 0.5215542912483215
30 81028 0.18006114661693573
31 81028 0.35503464937210083
32 81028 0.29924657940864563
33 81028 0.38751402497291565
34 81028 0.3475658595561981
35 81028 0.3996271789073944
36 81028 0.2831273376941681
37 81028 0.5799170136451721
38 81028 0.4103195369243622
39 81028 0.4238850772380829
40 81028 0.2791096568107605
41 81028 0.3737393319606781
42 81028 0.38474607467651367
43 81028 0.514777660369873
44 81028 0.3576599657535553
45 81028 0.31640490889549255
46 81028 0.35466325283050537
47 81028 0.3482142686843872
48 81028 0.38229504227638245
49 81028 0.33501946926116943
50 81028 0.34677842259407043
51 81028 0.253010630607605
52 81028 0.3166879117488861
53 81028 0.41005098819732666
54 81028 0.4067502021789551
55 81028 0.3634801506996155
56 81028 0.35823914408683777
57 81028 0.3284645974636078
58 81028 0.4448646306991577
59 81028 0.3080727159976959
60 81028 0.5698652267456055
61 81028 0.24518738687038422
62 81028 0.487141489982605
63 81028 0.3264842927455902
64 81028 0.3730242848396301
65 81028 0.31487080454826355
66 81028 0.39585357904434204
67 81028 0.32643982768058777
68 81028 0.26063647866249084
69 81028 0.28420478105545044
70 81028 0.3523378074169159
71 81028 0.3438241481781006
72 81028 0.3807017207145691
73 81028 0.352844774723053
74 81028 0.4428246319293976
75 81028 0.39388036727905273
76 81028 0.47609758377075195
77 81028 0.4851091504096985
78 81028 0.349448561668396
79 81028 0.42933735251426697
80 81028 0.35436487197875977
81 81028 0.25973328948020935
82 81028 0.3299795091152191
83 81028 0.15063253045082092
84 81028 0.1285627782344818
85 81028 0.1261885166168213
86 81028 0.16557659208774567
87 81028 0.24327711760997772
88 81028 0.411483496427536
89 81028 0.3421233296394348
90 81028 0.6658214926719666
91 81028 0.2977719008922577
92 81028 0.30255380272865295
93 81028 0.3421822190284729
94 81028 0.5175930857658386
95 81028 0.22374095022678375
96 81028 0.5791615843772888
97 81028 0.3963978588581085
98 81028 0.5797967314720154
99 81028 0.32360759377479553
100 81028 0.3014780580997467
101 81028 0.3361469507217407
102 81028 0.4085562229156494
103 81028 0.409706175327301
104 81028 0.3914670944213867
105 81028 0.4308910071849823
106 81028 0.38579052686691284
107 81028 0.37546592950820923
108 81028 0.2625369131565094
109 81028 0.2788773477077484
110 81028 0.24298027157783508
111 81028 0.272739440202713
112 81028 0.3420542776584625
113 81028 0.32297003269195557
114 81028 0.2595299780368805
115 81028 0.44118252396583557
116 81028 0.32402992248535156
117 81028 0.7270980477333069
118 81028 0.3455277979373932
119 81028 0.41881948709487915
120 81028 0.4433025121688843
121 81028 0.3416697680950165
122 81028 0.32168495655059814
123 81028 0.29547491669654846
124 81028 0.3134390115737915
125 81028 0.402251660823822
126 81028 0.7092658877372742
127 81028 0.15034231543540955
128 81028 0.14361348748207092
129 81028 0.2012573629617691
130 81028 0.12267852574586868
131 81028 0.2712695002555847
132 81028 0.2872157692909241
133 81028 0.40447428822517395
134 81028 0.34003931283950806
135 81028 0.2857574224472046
136 81028 0.2605482339859009
137 81028 0.22475038468837738
138 81028 0.27371785044670105
139 81028 0.4091961085796356
140 81028 0.39688169956207275
141 81028 0.3916375935077667
142 81028 0.3350098133087158
143 81028 0.3331308364868164
144 81028 0.3334764242172241
145 81028 0.2757919728755951
146 81028 0.3383810818195343
147 81028 0.42390191555023193
148 81028 0.23633041977882385
149 81028 0.13876233994960785
150 81028 0.14319796860218048
151 81028 0.3272843360900879
152 81028 0.2966681122779846
153 81028 0.2869516611099243
154 81028 0.24742555618286133
155 81028 0.33327585458755493
156 81028 0.30395030975341797
157 81028 0.30945372581481934
158 81028 0.17830157279968262
train - Global loss: 0.354687    Embedding norm: 12.4657   Triplets (all/active): 509.6/246663.4
Pos dist (min/mean/max): 1.1400/1.4514/1.8843   Neg dist (min/mean/max): 1.1730/1.6214/2.3303
0 31777 0.4187398850917816
1 31777 0.4879888892173767
2 31777 0.38516169786453247
3 31777 0.37655115127563477
4 31777 0.5229735970497131
5 31777 0.40558362007141113
6 31777 0.35862278938293457
7 31777 0.6619092226028442
8 31777 0.4996977150440216
9 31777 0.37050601840019226
10 31777 0.32706791162490845
11 31777 0.48393112421035767
12 31777 0.5931164026260376
13 31777 0.6371904611587524
14 31777 0.5413711667060852
15 31777 0.3568273186683655
16 31777 0.41650259494781494
17 31777 0.42435723543167114
18 31777 0.47833842039108276
19 31777 0.47574907541275024
20 31777 0.4871519207954407
21 31777 0.3478602468967438
22 31777 0.31885501742362976
23 31777 0.34750229120254517
24 31777 0.3022816777229309
25 31777 0.36325588822364807
26 31777 0.36832481622695923
27 31777 0.3561911880970001
28 31777 0.3833135664463043
29 31777 0.4063323736190796
30 31777 0.33889931440353394
31 31777 0.3760163187980652
32 31777 0.35925352573394775
33 31777 0.3724374771118164
34 31777 0.4085897207260132
35 31777 0.40117284655570984
36 31777 0.33858412504196167
37 31777 0.36512887477874756
38 31777 0.3906410038471222
39 31777 0.42656439542770386
40 31777 0.5094427466392517
41 31777 0.4550550878047943
42 31777 0.45788872241973877
43 31777 0.43241631984710693
44 31777 0.5124636888504028
45 31777 0.4269660413265228
46 31777 0.331432968378067
47 31777 0.3341832458972931
48 31777 0.4800081253051758
49 31777 0.40537524223327637
50 31777 0.38116544485092163
51 31777 0.36069411039352417
52 31777 0.3930276036262512
53 31777 0.388015478849411
54 31777 0.37652868032455444
55 31777 0.3818378448486328
56 31777 0.3798377513885498
57 31777 0.44723254442214966
58 31777 0.4575725197792053
59 31777 0.4404793083667755
60 31777 0.3946990370750427
61 31777 0.41148534417152405
62 31777 0.48775631189346313
val - Global loss: 0.417875    Embedding norm: 12.2931   Triplets (all/active): 504.4/257716.6
Pos dist (min/mean/max): 1.2524/1.5378/1.8967   Neg dist (min/mean/max): 1.1911/1.5991/2.5605
0 81028 0.4031713008880615
1 81028 0.4799598157405853
2 81028 0.34185054898262024
3 81028 0.3356376588344574
4 81028 0.21960994601249695
5 81028 0.3014666736125946
6 81028 0.43425726890563965
7 81028 0.4227927327156067
8 81028 0.3932090103626251
9 81028 0.37558087706565857
10 81028 0.16937679052352905
11 81028 0.24611055850982666
12 81028 0.3943142890930176
13 81028 0.28419122099876404
14 81028 0.25494149327278137
15 81028 0.3873448371887207
16 81028 0.17351192235946655
17 81028 0.383146733045578
18 81028 0.39194485545158386
19 81028 0.2549842298030853
20 81028 0.3564196527004242
21 81028 0.24973315000534058
22 81028 0.33425372838974
23 81028 0.3406287729740143
24 81028 0.3538704216480255
25 81028 0.30002060532569885
26 81028 0.42365482449531555
27 81028 0.25506892800331116
28 81028 0.38024255633354187
29 81028 0.526226282119751
30 81028 0.1494448482990265
31 81028 0.3230689465999603
32 81028 0.26798543334007263
33 81028 0.3373269736766815
34 81028 0.33979809284210205
35 81028 0.35647323727607727
36 81028 0.2296249121427536
37 81028 0.6154945492744446
38 81028 0.3752999007701874
39 81028 0.36103639006614685
40 81028 0.20214009284973145
41 81028 0.2703752815723419
42 81028 0.30407577753067017
43 81028 0.4514966309070587
44 81028 0.2855914235115051
45 81028 0.24318547546863556
46 81028 0.3326810598373413
47 81028 0.3128852844238281
48 81028 0.38137009739875793
49 81028 0.27351951599121094
50 81028 0.28428059816360474
51 81028 0.15872809290885925
52 81028 0.21797046065330505
53 81028 0.400661826133728
54 81028 0.39259105920791626
55 81028 0.2997729182243347
56 81028 0.27217933535575867
57 81028 0.2609252333641052
58 81028 0.39020389318466187
59 81028 0.27742329239845276
60 81028 0.7143250107765198
61 81028 0.05349375680088997
62 81028 0.40387246012687683
63 81028 0.2522502541542053
64 81028 0.2977084219455719
65 81028 0.2589048147201538
66 81028 0.2915605902671814
67 81028 0.22462299466133118
68 81028 0.17794793844223022
69 81028 0.19300921261310577
70 81028 0.2218862622976303
71 81028 0.2834286391735077
72 81028 0.3143351376056671
73 81028 0.3034856915473938
74 81028 0.3479892909526825
75 81028 0.3403240144252777
76 81028 0.41806760430336
Traceback (most recent call last):
  File "/code/RLoc/training/train.py", line 31, in <module>
    do_train(params, debug=args.debug, device=device)
  File "/code/RLoc/training/trainer.py", line 367, in do_train
    for index, (query, positives, negatives) in enumerate(dataloaders[phase]):
  File "/usr/local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/usr/local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1315, in _get_data
    success, data = self._try_get_data()
  File "/usr/local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/usr/local/lib/python3.9/queue.py", line 180, in get
    self.not_empty.wait(remaining)
  File "/usr/local/lib/python3.9/threading.py", line 316, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
