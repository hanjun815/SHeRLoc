  0%|                                                                                              | 0/120 [00:00<?, ?it/s]
0 11709 0.566158652305603
1 11709 0.9813690185546875
2 11709 0.7406648397445679
3 11709 0.6559922099113464
4 11709 1.061285376548767
5 11709 0.9533218741416931
6 11709 2.2384305000305176
7 11709 3.643291711807251
8 11709 2.0507049560546875
9 11709 1.6192189455032349
10 11709 0.9947099685668945
11 11709 0.5252662301063538
12 11709 0.32882872223854065
13 11709 0.19484953582286835
14 11709 0.2785104513168335
15 11709 0.49713748693466187
16 11709 0.24762307107448578
17 11709 0.26864853501319885
18 11709 0.5669854879379272
19 11709 0.6943835616111755
20 11709 0.9966742396354675
21 11709 0.37939560413360596
22 11709 0.22283554077148438
23 11709 0.4794393479824066
24 11709 0.49175581336021423
25 11709 0.5628442168235779
26 11709 0.3919205367565155
27 11709 0.2778288722038269
28 11709 0.5085180401802063
29 11709 0.2033393830060959
30 11709 0.21913689374923706
31 11709 0.33700498938560486
32 11709 0.4715202748775482
33 11709 0.46254947781562805
34 11709 0.917916476726532
35 11709 1.1814440488815308
36 11709 0.20310162007808685
37 11709 0.4140819013118744
38 11709 0.6143486499786377
39 11709 0.5834304094314575
40 11709 0.7752562165260315
41 11709 0.7605609893798828
42 11709 0.7241995334625244
43 11709 1.408044695854187
44 11709 2.4320507049560547
45 11709 2.100558280944824
46 11709 0.9728436470031738
47 11709 0.2524716556072235
48 11709 0.43802350759506226
49 11709 0.4298609793186188
50 11709 0.460867315530777
51 11709 0.3128749430179596
52 11709 0.4772956371307373
53 11709 1.1946566104888916
54 11709 1.6391338109970093
55 11709 0.7851879596710205
56 11709 0.5988887548446655
57 11709 0.5096963047981262
58 11709 0.4752575159072876
59 11709 0.332734078168869
60 11709 0.23518964648246765
61 11709 0.30037879943847656
62 11709 0.19807055592536926
63 11709 0.32042938470840454
64 11709 0.1959277242422104
65 11709 0.2076585590839386
66 11709 0.21402399241924286
67 11709 0.2492465078830719
68 11709 0.25816774368286133
69 11709 0.40891358256340027
70 11709 0.33516019582748413
71 11709 0.24483387172222137
72 11709 0.23060183227062225
73 11709 0.2692001461982727
74 11709 0.3498651683330536
75 11709 0.3263562321662903
76 11709 0.3705664277076721
77 11709 0.3975691497325897
78 11709 0.4736529290676117
79 11709 0.41928204894065857
80 11709 0.3386683166027069
81 11709 0.45591792464256287
82 11709 0.5984525084495544
83 11709 0.6403013467788696
84 11709 0.39843758940696716
85 11709 0.5721198320388794
86 11709 0.7727333307266235
87 11709 1.4043114185333252
88 11709 0.8697015047073364
89 11709 1.0723918676376343
90 11709 0.6881036162376404
91 11709 0.3970230221748352
92 11709 0.42743903398513794
93 11709 0.34887275099754333
94 11709 0.22839681804180145
95 11709 0.354796826839447
96 11709 0.24665480852127075
97 11709 0.5084083676338196
98 11709 0.3625378906726837
99 11709 0.45151668787002563
100 11709 0.3564334213733673
101 11709 0.7755304574966431
102 11709 0.9864378571510315
103 11709 1.0185366868972778
104 11709 0.4884093105792999
105 11709 0.7541471123695374
106 11709 0.9282008409500122
107 11709 0.7657091617584229
108 11709 0.9662907123565674
109 11709 0.4208870232105255
110 11709 0.2944170832633972
111 11709 0.24641378223896027
112 11709 0.12383470684289932
113 11709 0.21841609477996826
114 11709 0.17286764085292816
115 11709 0.2224901020526886
116 11709 0.3481226861476898
117 11709 0.4183763563632965
118 11709 0.5546899437904358
119 11709 0.4601655900478363
120 11709 0.49436384439468384
121 11709 0.611860454082489
122 11709 0.9160301685333252
123 11709 0.9654077887535095
124 11709 0.6458804607391357
125 11709 0.3444720208644867
126 11709 0.334199458360672
127 11709 0.5293819308280945
128 11709 0.46198800206184387
129 11709 0.6920411586761475
130 11709 0.3195808231830597
131 11709 0.19806869328022003
132 11709 0.20317980647087097
133 11709 0.33962079882621765
134 11709 1.6237684488296509
135 11709 1.233167290687561
136 11709 1.0282143354415894
137 11709 0.5406785607337952
138 11709 0.46214452385902405
139 11709 0.49980106949806213
140 11709 0.3671850264072418
141 11709 0.3140961825847626
142 11709 0.262783408164978
143 11709 0.2622995376586914
144 11709 0.24460110068321228
145 11709 0.2340506613254547
146 11709 0.2823638916015625
147 11709 0.19992981851100922
148 11709 0.2728208601474762
149 11709 0.20515666902065277
150 11709 0.20587459206581116
151 11709 0.5286637544631958
152 11709 0.44603437185287476
153 11709 0.35942342877388
154 11709 0.5937949419021606
155 11709 0.4174647629261017
156 11709 0.3615783154964447
157 11709 0.6909244060516357
158 11709 0.560457170009613
159 11709 0.334059476852417
160 11709 0.32890066504478455
161 11709 0.3503493368625641
162 11709 0.3458656072616577
163 11709 0.7011163830757141
164 11709 0.4816567599773407
165 11709 0.41616562008857727
166 11709 0.3883756101131439
167 11709 0.22981731593608856
168 11709 0.2583388090133667
169 11709 0.2945069372653961
170 11709 0.35710376501083374
171 11709 0.2327880859375
172 11709 0.13584566116333008
173 11709 0.13197101652622223
174 11709 0.37995263934135437
175 11709 0.5744633674621582
176 11709 0.34691861271858215
177 11709 0.24725650250911713
178 11709 0.27154645323753357
179 11709 0.39695125818252563
180 11709 0.593852698802948
181 11709 0.6329641342163086
182 11709 0.37849390506744385
183 11709 0.5037940740585327
184 11709 0.4739598035812378
185 11709 0.24751611053943634
186 11709 0.391863077878952
187 11709 0.2550429105758667
188 11709 0.2461564540863037
189 11709 0.275407075881958
190 11709 0.38131070137023926
191 11709 0.27648308873176575
192 11709 0.38735222816467285
193 11709 0.2503758370876312
194 11709 0.5122516751289368
195 11709 0.7246408462524414
196 11709 0.5505071878433228
197 11709 0.45558440685272217
198 11709 0.5094584822654724
199 11709 0.23156102001667023
200 11709 0.18462960422039032
201 11709 0.056182097643613815
202 11709 0.3188430666923523
203 11709 0.3639345169067383
204 11709 0.46736210584640503
205 11709 0.5055330991744995
206 11709 0.48293548822402954
207 11709 0.380403608083725
208 11709 0.3557911813259125
209 11709 0.19390366971492767
210 11709 0.26308637857437134
211 11709 0.23029132187366486
212 11709 0.3011522889137268
213 11709 0.2223079651594162
214 11709 0.2717566192150116
215 11709 0.19829973578453064
216 11709 0.33207595348358154
217 11709 0.4636027216911316
218 11709 0.2032451629638672
219 11709 0.3591732680797577
220 11709 0.29013925790786743
221 11709 0.3785092532634735
222 11709 0.5752705335617065
223 11709 0.35631656646728516
224 11709 0.4196186065673828
225 11709 0.7910052537918091
226 11709 0.5629278421401978
227 11709 0.20252187550067902
228 11709 0.804024338722229
229 11709 0.22195731103420258
230 11709 0.8576475977897644
231 11709 0.41566771268844604
232 11709 0.411750853061676
233 11709 0.611460268497467
234 11709 0.31898248195648193
235 11709 0.21846310794353485
236 11709 0.1787891536951065
237 11709 0.7243743538856506
238 11709 0.7285189628601074
239 11709 0.6337875723838806
240 11709 0.6161423921585083
241 11709 0.6035345196723938
242 11709 0.5962304472923279
243 11709 0.28123387694358826
244 11709 0.25066304206848145
245 11709 0.5821574330329895
246 11709 0.6880741715431213
247 11709 0.3006686866283417
248 11709 0.4779990017414093
249 11709 0.39514783024787903
250 11709 0.2554836869239807
251 11709 0.12511345744132996
252 11709 0.3699588179588318
253 11709 0.30332645773887634
254 11709 0.22933581471443176
255 11709 0.37527385354042053
256 11709 1.0815666913986206
257 11709 0.8364500999450684
258 11709 0.7428272366523743
259 11709 0.8112978339195251
260 11709 0.5417577624320984
261 11709 0.5698245763778687
262 11709 0.46461328864097595
263 11709 0.4215552806854248
264 11709 1.302234172821045
265 11709 0.7984685301780701
266 11709 0.3367730677127838
267 11709 1.171539306640625
268 11709 0.440700501203537
269 11709 0.16551630198955536
270 11709 0.21480098366737366
271 11709 0.30659037828445435
272 11709 0.40135928988456726
273 11709 0.478225976228714
274 11709 0.3001604974269867
275 11709 0.2727069854736328
276 11709 0.3861277401447296
277 11709 0.5357100367546082
278 11709 0.7428436279296875
279 11709 1.1367292404174805
280 11709 0.3526240289211273
281 11709 0.7799248099327087
282 11709 0.8896849751472473
283 11709 1.712181806564331
284 11709 1.1995797157287598
285 11709 0.6396412253379822
286 11709 0.9408444166183472
287 11709 0.536415696144104
288 11709 0.4901356101036072
289 11709 0.3941585123538971
290 11709 0.3445225954055786
291 11709 0.19167521595954895
292 11709 0.19210444390773773
293 11709 0.47581109404563904
294 11709 0.3426821231842041
295 11709 0.4186442792415619
296 11709 0.2879650294780731
297 11709 0.389205664396286
298 11709 0.532570481300354
299 11709 0.6608774065971375
300 11709 1.2805891036987305
301 11709 1.5520607233047485
302 11709 1.122334599494934
303 11709 0.43957802653312683
304 11709 0.23517201840877533
305 11709 0.30508100986480713
306 11709 0.4590402841567993
307 11709 0.7050602436065674
308 11709 0.4769477844238281
309 11709 0.28631895780563354
310 11709 0.3721735179424286
311 11709 0.23707455396652222
312 11709 1.081681728363037
313 11709 1.1149826049804688
314 11709 0.8663651943206787
315 11709 0.41637083888053894
316 11709 0.34409672021865845
317 11709 0.30160245299339294
318 11709 0.35785621404647827
319 11709 0.28526705503463745
320 11709 0.2906765043735504
321 11709 0.25921759009361267
322 11709 0.5962135791778564
323 11709 0.42043522000312805
324 11709 0.34833037853240967
325 11709 0.45669829845428467
326 11709 0.024218037724494934
327 11709 0.28088143467903137
328 11709 0.35928747057914734
329 11709 0.304234117269516
330 11709 0.46576690673828125
331 11709 0.4735541343688965
332 11709 0.3263007700443268
333 11709 0.26294636726379395
334 11709 0.5178268551826477
335 11709 0.4166085720062256
336 11709 0.24933725595474243
337 11709 0.43009132146835327
338 11709 0.26122984290122986
339 11709 0.3134007453918457
340 11709 0.9593921303749084
341 11709 0.6585476398468018
342 11709 0.6241800785064697
343 11709 0.42213359475135803
344 11709 0.2731861174106598
345 11709 0.17413856089115143
346 11709 0.22658172249794006
347 11709 0.26076263189315796
348 11709 0.31894928216934204
349 11709 0.4225054681301117
350 11709 0.1974824219942093
351 11709 0.49645066261291504
352 11709 0.18961568176746368
353 11709 0.3043367564678192
354 11709 0.29261234402656555
355 11709 0.24124100804328918
356 11709 0.526732325553894
357 11709 0.45599374175071716
358 11709 0.5643309354782104
359 11709 0.3594149053096771
360 11709 0.2841361463069916
361 11709 0.3499218821525574
362 11709 0.18018314242362976
363 11709 0.7393428087234497
364 11709 1.0725131034851074
365 11709 1.3590182065963745
train - Global loss: 0.514464    Embedding norm: 14.5951   Triplets (all/active): 32.0/22.2
Pos dist (min/mean/max): 2.1459/2.8920/3.8773   Neg dist (min/mean/max): 2.3142/4.4033/14.5108
0 9320 0.39597824215888977
1 9320 0.4871310591697693
2 9320 1.3052202463150024
3 9320 0.35376816987991333
4 9320 0.26889362931251526
5 9320 0.17014718055725098
6 9320 0.10266061127185822
7 9320 0.16906218230724335
8 9320 0.2705523669719696
9 9320 0.6266780495643616
10 9320 0.44778972864151
11 9320 0.22816967964172363
12 9320 0.20209349691867828
13 9320 0.2626400887966156
14 9320 0.4888607859611511
15 9320 0.3460735082626343
16 9320 0.31698065996170044
17 9320 0.4393799304962158
18 9320 0.4632498621940613
19 9320 0.262764036655426
20 9320 0.28507861495018005
21 9320 0.2355438470840454
22 9320 0.26416081190109253
23 9320 0.17029991745948792
24 9320 0.33250561356544495
25 9320 0.28115978837013245
26 9320 0.32207366824150085
27 9320 0.1782536655664444
28 9320 0.31373926997184753
29 9320 0.5677401423454285
30 9320 0.6547219753265381
31 9320 0.7377857565879822
32 9320 0.9089503288269043
33 9320 0.5330479741096497
34 9320 0.20832613110542297
35 9320 0.3806004226207733
36 9320 0.40829524397850037
37 9320 0.27333489060401917
38 9320 0.27223244309425354
39 9320 0.2330838292837143
40 9320 0.38780149817466736
41 9320 0.271708220243454
42 9320 0.26989078521728516
43 9320 0.5252716541290283
44 9320 0.4362729787826538
45 9320 0.5361962914466858
46 9320 0.6644048690795898
47 9320 0.23529236018657684
48 9320 0.3868046700954437
49 9320 0.2458067536354065
50 9320 0.19223465025424957
51 9320 0.15002337098121643
52 9320 0.38765791058540344
53 9320 0.41335558891296387
54 9320 0.24231883883476257
55 9320 0.384177565574646
56 9320 0.4107980728149414
57 9320 0.23386387526988983
58 9320 0.35628262162208557
59 9320 0.3915631175041199
60 9320 0.5793973803520203
61 9320 0.29126158356666565
62 9320 0.2383563369512558
63 9320 0.5416116118431091
64 9320 0.4724823534488678
65 9320 0.2315552532672882
66 9320 0.2507563531398773
67 9320 0.3084994852542877
68 9320 0.6537894606590271
69 9320 1.3252795934677124
70 9320 1.1658000946044922
71 9320 0.7803158164024353
72 9320 0.2772868573665619
73 9320 0.31827491521835327
74 9320 0.3860151171684265
75 9320 0.35310086607933044
76 9320 0.3100513815879822
77 9320 0.5880642533302307
78 9320 0.6161784529685974
79 9320 0.47070738673210144
80 9320 0.4997943937778473
81 9320 0.4882637858390808
82 9320 0.12639112770557404
83 9320 0.2500373125076294
84 9320 0.349045991897583
85 9320 0.2963229715824127
86 9320 0.3816284239292145
87 9320 1.3969322443008423
88 9320 1.1183083057403564
89 9320 0.1253560185432434
90 9320 0.2508837580680847
91 9320 0.11701961606740952
92 9320 0.27708539366722107
93 9320 0.4951744079589844
94 9320 0.5027852654457092
95 9320 0.951381266117096
96 9320 0.674225926399231
97 9320 0.4624064862728119
98 9320 0.2121245115995407
99 9320 0.324584424495697
100 9320 0.30729565024375916
101 9320 0.7529385089874268
102 9320 0.6222876906394958
103 9320 0.2690417170524597
104 9320 0.46320781111717224
105 9320 0.27871814370155334
106 9320 0.3693748414516449
107 9320 0.12676671147346497
108 9320 0.08352978527545929
109 9320 0.30386030673980713
110 9320 0.22173623740673065
111 9320 0.27213597297668457
112 9320 0.1162872165441513
113 9320 0.20012861490249634
114 9320 0.17641112208366394
115 9320 0.22148416936397552
116 9320 0.1598096787929535
117 9320 0.5779021978378296
118 9320 0.3094078600406647
119 9320 0.08782992511987686
120 9320 0.300249844789505
121 9320 0.11659663915634155
122 9320 0.16890451312065125
123 9320 0.34597745537757874
124 9320 0.22603271901607513
125 9320 0.2717229425907135
126 9320 0.4997689723968506
127 9320 0.4317242205142975
128 9320 0.3255990147590637
129 9320 0.0830780640244484
130 9320 0.18237128853797913
131 9320 0.2433418333530426
132 9320 0.3426985740661621
133 9320 0.45387381315231323
134 9320 0.46200665831565857
135 9320 0.2766297161579132
136 9320 0.22315628826618195
137 9320 0.4386149048805237
138 9320 0.43905121088027954
139 9320 0.5218608975410461
140 9320 0.5485966801643372
141 9320 0.49369296431541443
142 9320 0.47082605957984924
143 9320 0.498283326625824
144 9320 0.7356780171394348
145 9320 0.401542603969574
146 9320 0.06350453197956085
147 9320 0.28086867928504944
148 9320 0.24944926798343658
149 9320 0.22059200704097748
150 9320 0.21073763072490692
151 9320 0.3308262825012207
152 9320 0.2720171809196472
153 9320 0.4548490047454834
154 9320 0.4617098867893219
155 9320 0.3592427372932434
156 9320 0.352046400308609
157 9320 0.21022309362888336
158 9320 0.24350160360336304
159 9320 0.20026899874210358
160 9320 0.2659858465194702
161 9320 0.42440611124038696
162 9320 0.23347344994544983
163 9320 0.24956858158111572
164 9320 0.27202436327934265
165 9320 0.3075934648513794
166 9320 0.282959520816803
167 9320 0.5873004198074341
168 9320 0.6724286079406738
169 9320 0.27454787492752075
170 9320 0.24578890204429626
171 9320 0.5704939365386963
172 9320 0.5787668228149414
173 9320 0.41116875410079956
174 9320 0.7293156981468201
175 9320 0.31560462713241577
176 9320 0.36119991540908813
177 9320 0.9991057515144348
178 9320 0.4515511691570282
179 9320 0.21307310461997986
180 9320 0.3272812068462372
181 9320 0.16711397469043732
182 9320 0.2531201243400574
183 9320 0.42384567856788635
184 9320 0.5852557420730591
185 9320 0.7133435010910034
186 9320 0.7656669020652771
187 9320 0.6924526691436768
188 9320 0.24130725860595703
189 9320 0.28180044889450073
190 9320 0.1547674834728241
191 9320 0.1227467879652977
192 9320 0.19357338547706604
193 9320 0.4715992212295532
194 9320 0.2808636426925659
195 9320 0.3352212607860565
196 9320 0.3756195902824402
197 9320 0.2189922034740448
198 9320 0.22741694748401642
199 9320 0.34706592559814453
200 9320 0.2745499908924103
201 9320 0.1807287633419037
202 9320 0.3971516788005829
203 9320 0.4180178642272949
204 9320 0.6592961549758911
205 9320 0.39841508865356445
206 9320 0.21269309520721436
207 9320 0.28122448921203613
208 9320 0.27275580167770386
209 9320 0.8541725873947144
210 9320 1.322464108467102
211 9320 0.785372793674469
212 9320 0.43637076020240784
213 9320 0.3507852554321289
214 9320 0.384247362613678
215 9320 0.3126930892467499
216 9320 0.45844605565071106
217 9320 0.3112565875053406
218 9320 0.4303240478038788
219 9320 0.6450064778327942
220 9320 0.6851931810379028
221 9320 0.4988919198513031
222 9320 0.15649567544460297
223 9320 0.2732962965965271
224 9320 0.40843573212623596
225 9320 0.34362831711769104
226 9320 0.17228712141513824
227 9320 0.252664715051651
228 9320 0.9661145210266113
229 9320 0.5115548372268677
230 9320 0.19646315276622772
231 9320 0.26615414023399353
232 9320 0.1647736132144928
233 9320 0.22827884554862976
234 9320 0.47265562415122986
235 9320 0.897955596446991
236 9320 0.6634883284568787
237 9320 0.3586236536502838
238 9320 0.20502646267414093
239 9320 0.3177878260612488
240 9320 0.45870837569236755
241 9320 0.5378798842430115
242 9320 0.6110695600509644
243 9320 0.2919890284538269
244 9320 0.3948565125465393
245 9320 0.36190637946128845
246 9320 0.33475029468536377
247 9320 0.018706753849983215
248 9320 0.30867892503738403
249 9320 0.21897347271442413
250 9320 0.31628116965293884
251 9320 0.13100139796733856
252 9320 0.07192273437976837
253 9320 0.24767909944057465
254 9320 0.25480732321739197
255 9320 0.1910826861858368
256 9320 0.5702131986618042
257 9320 0.0
258 9320 0.35647743940353394
259 9320 0.13690237700939178
260 9320 0.10211896151304245
261 9320 0.49524635076522827
262 9320 0.18308506906032562
263 9320 0.1600986123085022
264 9320 0.3366040289402008
265 9320 0.4914988577365875
266 9320 0.2746933400630951
267 9320 0.14593394100666046
268 9320 0.19881117343902588
269 9320 0.3174486458301544
270 9320 0.40585970878601074
271 9320 0.47249147295951843
272 9320 0.23894183337688446
273 9320 0.2682763338088989
274 9320 0.4868091642856598
275 9320 0.6703497767448425
276 9320 0.4216693341732025
277 9320 0.4243895411491394
278 9320 0.5646787881851196
279 9320 0.6386246085166931
280 9320 0.530003011226654
281 9320 0.6208188533782959
282 9320 0.10859568417072296
283 9320 0.09201689064502716
284 9320 0.26423949003219604
285 9320 0.24070322513580322
286 9320 0.2794153690338135
287 9320 0.0448913611471653
288 9320 0.3839740753173828
289 9320 0.5777011513710022
290 9320 0.5665592551231384
291 9320 0.5531514286994934
val - Global loss: 0.381870    Embedding norm: 13.2403   Triplets (all/active): 31.9/21.0
Pos dist (min/mean/max): 1.9756/2.5449/3.3562   Neg dist (min/mean/max): 2.2210/3.9270/15.6543
0 11709 0.690418004989624
1 11709 0.45427367091178894
2 11709 0.3601541519165039
3 11709 0.29497087001800537
4 11709 0.28795140981674194
5 11709 0.18807439506053925
6 11709 0.6138421297073364
7 11709 0.8392554521560669
8 11709 0.33407190442085266
9 11709 0.3117414712905884
10 11709 0.20577742159366608
11 11709 0.017445996403694153
12 11709 0.2670159935951233
13 11709 0.1550048142671585
14 11709 0.0
Traceback (most recent call last):
  File "/code/RLoc/training/train.py", line 31, in <module>
    do_train(params, debug=args.debug, device=device)
  File "/code/RLoc/training/trainer.py", line 385, in do_train
    loss.backward()
  File "/usr/local/lib/python3.9/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/usr/local/lib/python3.9/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn
