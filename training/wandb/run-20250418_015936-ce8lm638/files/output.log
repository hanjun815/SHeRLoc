  0%|                                                   | 0/50 [00:00<?, ?it/s]
0 45360 0.4323710799217224
1 45360 0.45534294843673706
2 45360 0.4156152307987213
3 45360 0.47056132555007935
4 45360 0.42651277780532837
5 45360 0.3354588449001312
6 45360 0.4218083322048187
7 45360 0.32754650712013245
8 45360 0.35317444801330566
9 45360 0.5180480480194092
10 45360 0.5119800567626953
11 45360 0.48920369148254395
12 45360 0.4384879469871521
13 45360 0.5004410743713379
14 45360 0.43158450722694397
15 45360 0.39463090896606445
16 45360 0.3849468529224396
17 45360 0.37707510590553284
18 45360 0.4093681275844574
19 45360 0.3619817793369293
20 45360 0.3894389569759369
21 45360 0.3418969213962555
22 45360 0.4694705009460449
23 45360 0.4268926978111267
24 45360 0.4154454469680786
25 45360 0.31658127903938293
26 45360 0.28657346963882446
27 45360 0.3479762375354767
28 45360 0.36171185970306396
29 45360 0.3485746681690216
30 45360 0.3677601218223572
31 45360 0.30844444036483765
32 45360 0.35298433899879456
33 45360 0.35468870401382446
34 45360 0.37780484557151794
35 45360 0.3858841061592102
36 45360 0.2735818922519684
37 45360 0.41113632917404175
38 45360 0.2854430377483368
39 45360 0.3138176500797272
40 45360 0.29695719480514526
41 45360 0.31439846754074097
42 45360 0.27910590171813965
43 45360 0.26101094484329224
44 45360 0.26443207263946533
45 45360 0.27766934037208557
46 45360 0.28086185455322266
47 45360 0.3170565068721771
48 45360 0.34949418902397156
49 45360 0.31544575095176697
50 45360 0.2372523844242096
51 45360 0.20570074021816254
52 45360 0.2788528800010681
53 45360 0.3196444511413574
54 45360 0.31380560994148254
55 45360 0.34044310450553894
56 45360 0.30393892526626587
57 45360 0.2495221048593521
58 45360 0.22420452535152435
59 45360 0.24257336556911469
60 45360 0.2034590095281601
61 45360 0.2097170650959015
62 45360 0.2780291736125946
63 45360 0.24107441306114197
64 45360 0.2301756888628006
65 45360 0.24090151488780975
66 45360 0.17417022585868835
67 45360 0.24729476869106293
68 45360 0.31121793389320374
69 45360 0.2788133919239044
70 45360 0.28323641419410706
71 45360 0.3493623733520508
72 45360 0.19559451937675476
73 45360 0.1935552954673767
74 45360 0.29569464921951294
75 45360 0.2431361824274063
76 45360 0.2912176251411438
77 45360 0.32440465688705444
78 45360 0.21385972201824188
79 45360 0.2632586658000946
80 45360 0.1770264357328415
81 45360 0.19972872734069824
82 45360 0.18007339537143707
83 45360 0.2001541554927826
84 45360 0.2155410498380661
85 45360 0.22055892646312714
86 45360 0.18406125903129578
87 45360 0.12530799210071564
88 45360 0.2226739078760147
89 45360 0.29022216796875
90 45360 0.21588274836540222
91 45360 0.1525961458683014
92 45360 0.20667077600955963
93 45360 0.23441672325134277
94 45360 0.3012728691101074
95 45360 0.20048873126506805
96 45360 0.2237028181552887
97 45360 0.1941719502210617
98 45360 0.2484133243560791
99 45360 0.36278629302978516
100 45360 0.27326107025146484
101 45360 0.25447961688041687
102 45360 0.22497601807117462
103 45360 0.2175758332014084
104 45360 0.2274400293827057
105 45360 0.25103649497032166
106 45360 0.33025768399238586
107 45360 0.22438326478004456
108 45360 0.2690194547176361
109 45360 0.3117678761482239
110 45360 0.20863452553749084
111 45360 0.22576937079429626
112 45360 0.19350627064704895
113 45360 0.20177461206912994
114 45360 0.15826265513896942
115 45360 0.15244494378566742
116 45360 0.2489340454339981
117 45360 0.18834231793880463
118 45360 0.2128940224647522
119 45360 0.21834339201450348
120 45360 0.2141837179660797
121 45360 0.19362828135490417
122 45360 0.2748757600784302
123 45360 0.21659515798091888
124 45360 0.16889376938343048
125 45360 0.2764699161052704
126 45360 0.3538288176059723
127 45360 0.523640513420105
128 45360 0.38823649287223816
129 45360 0.38376250863075256
130 45360 0.48105335235595703
131 45360 0.484641432762146
132 45360 0.49522504210472107
133 45360 0.48368144035339355
134 45360 0.48576411604881287
135 45360 0.3372765779495239
136 45360 0.2509305775165558
137 45360 0.3572178781032562
138 45360 0.3439573347568512
139 45360 0.26493027806282043
140 45360 0.2104538381099701
141 45360 0.28656983375549316
142 45360 0.29498863220214844
143 45360 0.22254031896591187
144 45360 0.2777348458766937
145 45360 0.313272088766098
146 45360 0.4431375563144684
147 45360 0.4279833137989044
148 45360 0.3414155840873718
149 45360 0.30003055930137634
150 45360 0.30977144837379456
151 45360 0.3043246567249298
152 45360 0.2955153286457062
153 45360 0.31924256682395935
154 45360 0.28566277027130127
155 45360 0.5021753907203674
156 45360 0.2708030343055725
157 45360 0.19772249460220337
158 45360 0.1915849894285202
159 45360 0.1789274513721466
160 45360 0.24427390098571777
161 45360 0.2924271821975708
162 45360 0.24750059843063354
163 45360 0.23623403906822205
164 45360 0.2540305256843567
165 45360 0.29407206177711487
166 45360 0.2644135355949402
167 45360 0.22338826954364777
168 45360 0.3312104046344757
169 45360 0.23701442778110504
170 45360 0.19344313442707062
171 45360 0.18996556103229523
172 45360 0.32417798042297363
173 45360 0.23038004338741302
174 45360 0.2000371366739273
175 45360 0.19221623241901398
176 45360 0.18807856738567352
177 45360 0.1951199471950531
178 45360 0.25679370760917664
179 45360 0.23694579303264618
180 45360 0.2923389971256256
181 45360 0.22768865525722504
182 45360 0.2917220890522003
183 45360 0.3123815953731537
184 45360 0.17389437556266785
185 45360 0.2402217984199524
186 45360 0.18770499527454376
187 45360 0.1829407960176468
188 45360 0.22768695652484894
189 45360 0.22549961507320404
190 45360 0.14714883267879486
191 45360 0.12478596717119217
192 45360 0.17544953525066376
193 45360 0.18233822286128998
194 45360 0.15292209386825562
195 45360 0.30182626843452454
196 45360 0.2646259069442749
197 45360 0.26469990611076355
198 45360 0.23545564711093903
199 45360 0.25164979696273804
200 45360 0.2083302140235901
201 45360 0.12077721208333969
202 45360 0.1439397782087326
203 45360 0.19758740067481995
204 45360 0.14413829147815704
205 45360 0.18985138833522797
206 45360 0.19503507018089294
207 45360 0.19895511865615845
208 45360 0.14411230385303497
209 45360 0.21917831897735596
210 45360 0.24212585389614105
211 45360 0.07799182087182999
212 45360 0.12234508991241455
213 45360 0.16555263102054596
214 45360 0.1889120191335678
215 45360 0.21982912719249725
216 45360 0.1996915638446808
217 45360 0.17337624728679657
218 45360 0.16276058554649353
219 45360 0.20775428414344788
220 45360 0.1620916724205017
221 45360 0.19094210863113403
222 45360 0.18714292347431183
223 45360 0.1753217726945877
224 45360 0.14838670194149017
225 45360 0.12087968736886978
226 45360 0.18337462842464447
train - Global loss: 0.274094    Embedding norm: 1.0000   Triplets (all/active): 199.8/32306.2
Pos dist (min/mean/max): 0.7311/1.1395/1.5301   Neg dist (min/mean/max): 0.8924/1.4064/1.7563
0 1011 0.12373720109462738
1 1011 0.11924688518047333
2 1011 0.11384233087301254
3 1011 0.11465621739625931
4 1011 0.15747205913066864
5 1011 0.12789393961429596
val - Global loss: 0.126141    Embedding norm: 1.0000   Triplets (all/active): 168.5/24513.2
Pos dist (min/mean/max): 0.3990/0.5734/0.7664   Neg dist (min/mean/max): 0.4319/0.8209/1.0572
0 45360 0.22454649209976196
1 45360 0.25829097628593445
2 45360 0.24588245153427124
3 45360 0.3073311150074005
4 45360 0.32081979513168335
5 45360 0.19730313122272491
6 45360 0.2199651598930359
7 45360 0.22588685154914856
8 45360 0.20279712975025177
9 45360 0.22258207201957703
10 45360 0.23068363964557648
11 45360 0.20007817447185516
12 45360 0.2874758839607239
13 45360 0.2404831200838089
14 45360 0.20621530711650848
15 45360 0.19058798253536224
16 45360 0.3087000250816345
17 45360 0.22263018786907196
18 45360 0.1835412234067917
19 45360 0.13085611164569855
20 45360 0.19348981976509094
21 45360 0.19608673453330994
22 45360 0.20593231916427612
23 45360 0.17720189690589905
24 45360 0.21607248485088348
25 45360 0.26919227838516235
26 45360 0.1640601009130478
27 45360 0.2203424721956253
28 45360 0.18653152883052826
29 45360 0.2498774230480194
30 45360 0.1887901872396469
31 45360 0.20258432626724243
32 45360 0.2703882157802582
33 45360 0.19692717492580414
34 45360 0.26071152091026306
35 45360 0.2004607617855072
36 45360 0.19804750382900238
37 45360 0.19504907727241516
38 45360 0.21749107539653778
39 45360 0.24483780562877655
40 45360 0.1969045251607895
41 45360 0.17490625381469727
42 45360 0.17634138464927673
43 45360 0.14116604626178741
44 45360 0.18522126972675323
45 45360 0.16419029235839844
46 45360 0.19499415159225464
47 45360 0.16655844449996948
48 45360 0.23506760597229004
49 45360 0.21047070622444153
50 45360 0.18890510499477386
51 45360 0.1836692988872528
52 45360 0.17804419994354248
53 45360 0.2109343260526657
54 45360 0.21074505150318146
55 45360 0.22014181315898895
56 45360 0.19957570731639862
57 45360 0.1835392415523529
58 45360 0.13632144033908844
59 45360 0.13773086667060852
60 45360 0.12416736036539078
61 45360 0.14229227602481842
62 45360 0.19671200215816498
63 45360 0.18220816552639008
64 45360 0.21054057776927948
65 45360 0.1588861048221588
66 45360 0.15763331949710846
67 45360 0.22202153503894806
68 45360 0.19148655235767365
69 45360 0.24374236166477203
70 45360 0.16674400866031647
71 45360 0.28424423933029175
72 45360 0.17754404246807098
73 45360 0.15683211386203766
74 45360 0.2188413441181183
75 45360 0.1878015697002411
76 45360 0.14104105532169342
77 45360 0.21794097125530243
78 45360 0.17862650752067566
79 45360 0.17516490817070007
80 45360 0.14925341308116913
81 45360 0.12665961682796478
82 45360 0.14031068980693817
83 45360 0.15829525887966156
84 45360 0.183384969830513
85 45360 0.1858437955379486
86 45360 0.1145092248916626
87 45360 0.08725246787071228
88 45360 0.1741378754377365
89 45360 0.20171423256397247
90 45360 0.16987237334251404
91 45360 0.11031795293092728
92 45360 0.1337776929140091
93 45360 0.18364112079143524
94 45360 0.17369107902050018
95 45360 0.14772039651870728
96 45360 0.17472520470619202
97 45360 0.18637923896312714
98 45360 0.17685993015766144
99 45360 0.2717552185058594
100 45360 0.28429359197616577
101 45360 0.19515067338943481
102 45360 0.14897264540195465
103 45360 0.16882799565792084
104 45360 0.14856179058551788
105 45360 0.20504561066627502
106 45360 0.2720291316509247
107 45360 0.2106441706418991
108 45360 0.23361918330192566
109 45360 0.288875550031662
110 45360 0.18777404725551605
111 45360 0.1714475154876709
112 45360 0.1027810201048851
113 45360 0.1712253838777542
114 45360 0.1449255645275116
115 45360 0.12391631305217743
116 45360 0.1928868442773819
117 45360 0.20771656930446625
118 45360 0.1854773461818695
119 45360 0.1751769781112671
120 45360 0.18769711256027222
121 45360 0.15567439794540405
122 45360 0.21340177953243256
123 45360 0.2006906419992447
124 45360 0.12154185771942139
125 45360 0.17294177412986755
126 45360 0.27874985337257385
127 45360 0.5187583565711975
128 45360 0.3430688679218292
129 45360 0.343138188123703
130 45360 0.3616139590740204
131 45360 0.4292764365673065
132 45360 0.4161791205406189
133 45360 0.4836622476577759
134 45360 0.43680432438850403
135 45360 0.305891752243042
136 45360 0.20107458531856537
137 45360 0.23563902080059052
138 45360 0.2250230610370636
139 45360 0.17161297798156738
140 45360 0.20094384253025055
141 45360 0.18523333966732025
142 45360 0.2316001057624817
143 45360 0.19174709916114807
144 45360 0.25322696566581726
145 45360 0.30675530433654785
146 45360 0.3107355833053589
147 45360 0.31907230615615845
148 45360 0.3097400367259979
149 45360 0.26479873061180115
150 45360 0.2990935742855072
151 45360 0.24505601823329926
152 45360 0.2252514511346817
153 45360 0.24304908514022827
154 45360 0.2001117467880249
155 45360 0.4687057137489319
156 45360 0.18430466949939728
157 45360 0.1570127308368683
158 45360 0.13920080661773682
159 45360 0.14527800679206848
160 45360 0.22897692024707794
161 45360 0.18370364606380463
162 45360 0.19645673036575317
163 45360 0.182437464594841
164 45360 0.2060442715883255
165 45360 0.20807456970214844
166 45360 0.17530806362628937
167 45360 0.18680612742900848
168 45360 0.29434987902641296
169 45360 0.24398523569107056
170 45360 0.12518435716629028
171 45360 0.20013843476772308
172 45360 0.266209214925766
173 45360 0.21471810340881348
174 45360 0.13343890011310577
175 45360 0.08719517290592194
176 45360 0.11034738272428513
177 45360 0.18148057162761688
178 45360 0.20239485800266266
179 45360 0.15737444162368774
180 45360 0.22601673007011414
181 45360 0.15262533724308014
182 45360 0.19423602521419525
183 45360 0.2205207198858261
184 45360 0.1218460202217102
185 45360 0.1659049242734909
186 45360 0.12991823256015778
187 45360 0.16918477416038513
188 45360 0.17651334404945374
189 45360 0.2333345115184784
190 45360 0.103473000228405
191 45360 0.10680805146694183
192 45360 0.14836135506629944
193 45360 0.1595541387796402
194 45360 0.1473674476146698
195 45360 0.23151114583015442
196 45360 0.21807847917079926
197 45360 0.22271817922592163
198 45360 0.23758500814437866
199 45360 0.17352595925331116
200 45360 0.21398232877254486
201 45360 0.1882839947938919
202 45360 0.11213710904121399
203 45360 0.18206799030303955
204 45360 0.14115095138549805
205 45360 0.18418508768081665
206 45360 0.14194516837596893
207 45360 0.14849509298801422
208 45360 0.12880957126617432
209 45360 0.136564701795578
210 45360 0.1962720900774002
211 45360 0.08412597328424454
212 45360 0.10392295569181442
213 45360 0.16834579408168793
214 45360 0.14469927549362183
215 45360 0.1592518538236618
216 45360 0.1492704600095749
217 45360 0.15821610391139984
218 45360 0.13852980732917786
219 45360 0.172946959733963
220 45360 0.1294933259487152
221 45360 0.14383290708065033
222 45360 0.1424558460712433
223 45360 0.12257527559995651
224 45360 0.14769841730594635
225 45360 0.12631770968437195
226 45360 0.1463308036327362
train - Global loss: 0.199996    Embedding norm: 1.0000   Triplets (all/active): 199.8/26960.5
Pos dist (min/mean/max): 0.6756/1.0455/1.4280   Neg dist (min/mean/max): 0.9394/1.4078/1.7382
0 1011 0.16389165818691254
1 1011 0.17058730125427246
2 1011 0.1547640562057495
3 1011 0.1649792641401291
4 1011 0.22886872291564941
5 1011 0.07403211295604706
val - Global loss: 0.159521    Embedding norm: 1.0000   Triplets (all/active): 168.5/25581.8
Pos dist (min/mean/max): 0.3014/0.5018/0.7208   Neg dist (min/mean/max): 0.3405/0.7566/1.0313
0 45360 0.14984378218650818
1 45360 0.2000543624162674
2 45360 0.1767294555902481
3 45360 0.21451227366924286
4 45360 0.28695374727249146
5 45360 0.1971885710954666
6 45360 0.19145408272743225
7 45360 0.20316308736801147
8 45360 0.17721879482269287
9 45360 0.1823250949382782
10 45360 0.18106520175933838
11 45360 0.1580486297607422
12 45360 0.21960994601249695
13 45360 0.2485649585723877
14 45360 0.17345309257507324
Traceback (most recent call last):
  File "/code/RLoc/training/train.py", line 31, in <module>
    do_train(params, debug=args.debug, device=device)
  File "/code/RLoc/training/trainer.py", line 410, in do_train
    torch.cuda.empty_cache()
  File "/usr/local/lib/python3.9/site-packages/torch/cuda/memory.py", line 121, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
