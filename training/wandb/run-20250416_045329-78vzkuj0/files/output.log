  0%|                                                    | 0/80 [00:00<?, ?it/s]
0 25113 0.4406129717826843
1 25113 0.5090731382369995
2 25113 0.39494332671165466
3 25113 0.43548500537872314
4 25113 0.4807381331920624
5 25113 0.3525562882423401
6 25113 0.4154004156589508
7 25113 0.4569169878959656
8 25113 0.3150143325328827
9 25113 0.385303258895874
10 25113 0.5287192463874817
11 25113 0.5044032335281372
12 25113 0.5645532608032227
13 25113 0.4670812487602234
14 25113 0.5145685076713562
15 25113 0.43074870109558105
16 25113 0.39880090951919556
17 25113 0.3179134428501129
18 25113 0.31510183215141296
19 25113 0.34327930212020874
20 25113 0.34656524658203125
21 25113 0.4497070610523224
22 25113 0.3508928120136261
23 25113 0.3894069194793701
24 25113 0.3853817880153656
25 25113 0.3574330806732178
26 25113 0.4436626732349396
27 25113 0.40647944808006287
28 25113 0.35530343651771545
29 25113 0.33216652274131775
30 25113 0.39850205183029175
31 25113 0.45422038435935974
32 25113 0.38287314772605896
33 25113 0.3573456108570099
34 25113 0.3370097875595093
35 25113 0.3932460844516754
36 25113 0.35259050130844116
37 25113 0.3700166344642639
38 25113 0.34528398513793945
39 25113 0.4053751826286316
40 25113 0.3030039072036743
41 25113 0.3799284100532532
42 25113 0.3015923500061035
43 25113 0.2402157485485077
44 25113 0.24158871173858643
45 25113 0.23857815563678741
46 25113 0.2870014011859894
47 25113 0.31182798743247986
48 25113 0.33621299266815186
49 25113 0.33502963185310364
50 25113 0.30215713381767273
51 25113 0.3753497302532196
52 25113 0.35770857334136963
53 25113 0.36035090684890747
54 25113 0.38153326511383057
55 25113 0.34711140394210815
56 25113 0.3439134657382965
57 25113 0.2785664200782776
58 25113 0.3969358801841736
59 25113 0.32915666699409485
60 25113 0.38017675280570984
61 25113 0.3731500208377838
62 25113 0.3243029713630676
63 25113 0.30382975935935974
64 25113 0.21043650805950165
65 25113 0.2720642685890198
66 25113 0.28114721179008484
67 25113 0.33795732259750366
68 25113 0.28380560874938965
69 25113 0.29842910170555115
70 25113 0.29730281233787537
71 25113 0.3365115225315094
72 25113 0.3299564719200134
73 25113 0.2711714506149292
74 25113 0.32138127088546753
75 25113 0.30728936195373535
76 25113 0.30409714579582214
77 25113 0.3118002712726593
78 25113 0.376086562871933
79 25113 0.3613507151603699
80 25113 0.32436367869377136
81 25113 0.30162525177001953
82 25113 0.37679287791252136
83 25113 0.30570128560066223
84 25113 0.3395719528198242
85 25113 0.26690858602523804
86 25113 0.3275097906589508
87 25113 0.36696767807006836
88 25113 0.1957167237997055
89 25113 0.27154260873794556
90 25113 0.2787835896015167
91 25113 0.3202020525932312
92 25113 0.22239698469638824
93 25113 0.3190411329269409
94 25113 0.2880111634731293
95 25113 0.2645820379257202
96 25113 0.23851723968982697
97 25113 0.2752135992050171
98 25113 0.3450942933559418
99 25113 0.29785704612731934
100 25113 0.3195491135120392
101 25113 0.2293114811182022
102 25113 0.2579127848148346
103 25113 0.26351431012153625
104 25113 0.25334611535072327
105 25113 0.30884939432144165
106 25113 0.25570258498191833
107 25113 0.2788088619709015
108 25113 0.2879699468612671
109 25113 0.2797364890575409
110 25113 0.26513350009918213
111 25113 0.3607255220413208
112 25113 0.3560742139816284
113 25113 0.24897941946983337
114 25113 0.23573867976665497
115 25113 0.22889024019241333
116 25113 0.2572129964828491
117 25113 0.28456759452819824
118 25113 0.4074415862560272
119 25113 0.2777721881866455
120 25113 0.25417208671569824
121 25113 0.256879985332489
122 25113 0.243215873837471
123 25113 0.19874577224254608
124 25113 0.27552446722984314
125 25113 0.28342097997665405
126 25113 0.21176651120185852
127 25113 0.2818446457386017
128 25113 0.22029750049114227
129 25113 0.2710130512714386
130 25113 0.3142409920692444
131 25113 0.24392083287239075
132 25113 0.19201134145259857
133 25113 0.3141632676124573
134 25113 0.2422551065683365
135 25113 0.2872971296310425
136 25113 0.19023457169532776
137 25113 0.2605226933956146
138 25113 0.2312171459197998
139 25113 0.1891525238752365
train - Global loss: 0.324716    Embedding norm: 1.0000   Triplets (all/active): 179.4/30158.7
Pos dist (min/mean/max): 0.3282/0.6706/0.9973   Neg dist (min/mean/max): 0.4211/0.8387/1.1717
0 1011 0.18652978539466858
1 1011 0.18516339361667633
2 1011 0.3768197000026703
3 1011 0.18850065767765045
4 1011 0.2157011479139328
5 1011 0.6261910200119019
val - Global loss: 0.296484    Embedding norm: 1.0000   Triplets (all/active): 168.5/26156.0
Pos dist (min/mean/max): 0.0320/0.2921/0.7942   Neg dist (min/mean/max): 0.0357/0.4404/1.2268
0 25113 0.22580255568027496
1 25113 0.21552859246730804
2 25113 0.16020162403583527
3 25113 0.1929510086774826
4 25113 0.29251235723495483
5 25113 0.1776672899723053
6 25113 0.2069287747144699
7 25113 0.17948409914970398
8 25113 0.12315405160188675
9 25113 0.14422257244586945
10 25113 0.17102684080600739
11 25113 0.10310894250869751
12 25113 0.15707659721374512
13 25113 0.36644333600997925
14 25113 0.20773528516292572
15 25113 0.16792228817939758
16 25113 0.09136736392974854
17 25113 0.06015637144446373
18 25113 0.3162105679512024
19 25113 0.3332226276397705
20 25113 0.2898220419883728
21 25113 0.45133960247039795
22 25113 0.307410329580307
23 25113 0.21536554396152496
24 25113 0.2911568880081177
25 25113 0.22451835870742798
26 25113 0.2327612191438675
27 25113 0.1812928318977356
28 25113 0.1391899287700653
29 25113 0.14783552289009094
30 25113 0.16173145174980164
31 25113 0.24101942777633667
32 25113 0.13801395893096924
33 25113 0.12710987031459808
34 25113 0.13891933858394623
35 25113 0.1666976809501648
36 25113 0.20327477157115936
37 25113 0.15169773995876312
38 25113 0.1091209426522255
39 25113 0.12621021270751953
40 25113 0.4492829442024231
41 25113 0.2881242334842682
42 25113 0.17882274091243744
43 25113 0.09677467495203018
44 25113 0.0664966031908989
45 25113 0.3325633108615875
46 25113 0.31945815682411194
47 25113 0.1237495094537735
48 25113 0.44850632548332214
49 25113 0.10829298943281174
50 25113 0.25533148646354675
51 25113 0.4081917405128479
52 25113 0.1865188330411911
53 25113 0.11108731478452682
54 25113 0.10837163031101227
55 25113 0.1320551335811615
56 25113 0.10463438928127289
57 25113 0.014368593692779541
58 25113 0.07529477030038834
59 25113 0.539954662322998
60 25113 0.13707758486270905
61 25113 0.18506371974945068
62 25113 0.11672423034906387
63 25113 0.5214229226112366
64 25113 0.2979763448238373
65 25113 0.22464637458324432
66 25113 0.11286745965480804
67 25113 0.5352289080619812
68 25113 0.10092096030712128
69 25113 0.21967588365077972
70 25113 0.15208163857460022
71 25113 0.13167981803417206
72 25113 0.0715775415301323
73 25113 0.040391240268945694
74 25113 0.18411961197853088
75 25113 0.34786316752433777
76 25113 0.2470899224281311
77 25113 0.22600282728672028
78 25113 0.1988248974084854
79 25113 0.20718394219875336
80 25113 0.09120146185159683
81 25113 0.061258841305971146
82 25113 0.08428005874156952
83 25113 0.5842185616493225
84 25113 0.23893369734287262
85 25113 0.028128350153565407
86 25113 0.05791478976607323
87 25113 0.644452691078186
88 25113 0.3355850577354431
89 25113 0.63978111743927
90 25113 0.18041318655014038
91 25113 0.7166584134101868
92 25113 0.19124695658683777
93 25113 0.27870282530784607
94 25113 0.24566295742988586
95 25113 0.20725314319133759
96 25113 0.2354273796081543
97 25113 0.23795101046562195
98 25113 0.21451768279075623
99 25113 0.2322445809841156
100 25113 0.19729046523571014
101 25113 0.1629309058189392
102 25113 0.20559190213680267
103 25113 0.2883279621601105
104 25113 0.18503853678703308
105 25113 0.16833865642547607
106 25113 0.2072584480047226
107 25113 0.15543925762176514
108 25113 0.251932293176651
109 25113 0.1822340488433838
110 25113 0.1817641705274582
111 25113 0.1159278154373169
112 25113 0.08440987765789032
113 25113 0.06105101853609085
114 25113 0.0903250202536583
115 25113 0.049731042236089706
116 25113 0.34217047691345215
117 25113 0.5227847099304199
118 25113 0.12547200918197632
119 25113 0.0531737320125103
120 25113 0.0
121 25113 0.2561515271663666
122 25113 0.34445667266845703
123 25113 0.17677082121372223
124 25113 0.556350827217102
125 25113 0.12128476053476334
126 25113 0.06972073763608932
127 25113 0.0783858522772789
128 25113 0.1282588690519333
129 25113 0.29007187485694885
130 25113 0.12984848022460938
131 25113 0.10664528608322144
132 25113 0.9262648820877075
133 25113 0.8477513194084167
134 25113 0.39837372303009033
135 25113 0.6591911315917969
136 25113 0.21405421197414398
137 25113 0.18345989286899567
138 25113 0.4459124803543091
139 25113 0.6614530682563782
train - Global loss: 0.230535    Embedding norm: 1.0000   Triplets (all/active): 179.4/16306.7
Pos dist (min/mean/max): 0.2539/0.6229/1.0270   Neg dist (min/mean/max): 0.5342/1.1125/1.5825
0 1011 0.7099995613098145
1 1011 0.6420711278915405
2 1011 0.49322694540023804
3 1011 0.6540530323982239
4 1011 0.31439971923828125
5 1011 0.6779470443725586
val - Global loss: 0.581950    Embedding norm: 1.0000   Triplets (all/active): 168.5/29053.5
Pos dist (min/mean/max): 0.0892/0.5197/1.4169   Neg dist (min/mean/max): 0.0360/0.5253/1.4331
0 25113 0.35969066619873047
1 25113 0.1515737622976303
2 25113 0.3054068386554718
3 25113 0.2358354777097702
4 25113 0.1174440011382103
5 25113 0.18296843767166138
6 25113 0.6408194899559021
7 25113 0.10671224445104599
8 25113 0.47163906693458557
9 25113 0.5727452635765076
10 25113 0.25047776103019714
11 25113 0.07997024804353714
12 25113 0.7455561757087708
13 25113 0.5093114376068115
14 25113 0.6032588481903076
15 25113 0.34267058968544006
16 25113 0.23177629709243774
17 25113 0.5132940411567688
18 25113 0.2149726003408432
19 25113 0.17860732972621918
20 25113 0.21764323115348816
21 25113 0.20170587301254272
Traceback (most recent call last):
  File "/code/RLoc/training/train.py", line 31, in <module>
    do_train(params, debug=args.debug, device=device)
  File "/code/RLoc/training/trainer.py", line 410, in do_train
    torch.cuda.empty_cache()
  File "/usr/local/lib/python3.9/site-packages/torch/cuda/memory.py", line 121, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
